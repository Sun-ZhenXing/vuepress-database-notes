<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.61">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/vuepress-database-notes/favicon.svg"><title>数据库系统概论笔记 | 数据库笔记合集</title><meta name="description" content="数据库系统概论笔记">
    <link rel="preload" href="/vuepress-database-notes/assets/style-1fad6e46.css" as="style"><link rel="stylesheet" href="/vuepress-database-notes/assets/style-1fad6e46.css">
    <link rel="modulepreload" href="/vuepress-database-notes/assets/app-50be7c2c.js"><link rel="modulepreload" href="/vuepress-database-notes/assets/framework-8980b429.js"><link rel="modulepreload" href="/vuepress-database-notes/assets/index.html-94cf8681.js"><link rel="modulepreload" href="/vuepress-database-notes/assets/index.html-ab2cf381.js"><link rel="prefetch" href="/vuepress-database-notes/assets/index.html-21e99fcc.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/index.html-86cff8c0.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/index.html-0fe46f7d.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/recursion.html-a34b4354.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/uuid.html-165070e9.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/index.html-edaaa286.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/index.html-741ce238.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/reset-password.html-387eec1b.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/404.html-e7f61752.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/index.html-c2da4800.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/index.html-1e165e12.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/index.html-ef99483d.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/recursion.html-dcaeb9ce.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/uuid.html-ba5f154d.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/index.html-b6dfa5a8.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/index.html-822baa90.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/reset-password.html-ad10152f.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/404.html-b3328390.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/mermaid.esm.min-5a2d3551.js" as="script"><link rel="prefetch" href="/vuepress-database-notes/assets/SearchResult-6d8a6020.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/vuepress-database-notes/" class=""><img class="logo" src="/vuepress-database-notes/favicon.svg" alt="数据库笔记合集"><span class="site-name can-hide">数据库笔记合集</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库系统概论"><span class="title">数据库系统概论</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库系统概论"><span class="title">数据库系统概论</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/vuepress-database-notes/database/" class="router-link-active router-link-exact-active router-link-active" aria-label="数据库系统概论"><!--[--><!--]--> 数据库系统概论 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/vuepress-database-notes/mysql/" class="" aria-label="MySQL 笔记"><!--[--><!--]--> MySQL 笔记 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/Sun-ZhenXing/vuepress-database-notes/" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!--[--><button class="search-pro-button" role="search" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">搜索</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库系统概论"><span class="title">数据库系统概论</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库系统概论"><span class="title">数据库系统概论</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/vuepress-database-notes/database/" class="router-link-active router-link-exact-active router-link-active" aria-label="数据库系统概论"><!--[--><!--]--> 数据库系统概论 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/vuepress-database-notes/mysql/" class="" aria-label="MySQL 笔记"><!--[--><!--]--> MySQL 笔记 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/Sun-ZhenXing/vuepress-database-notes/" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">数据库系统概论 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-database-notes/database/" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="数据库系统概论笔记"><!--[--><!--]--> 数据库系统概论笔记 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-1-基本概念" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.1 基本概念"><!--[--><!--]--> 1.1 基本概念 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-2-数据库发展阶段" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.2 数据库发展阶段"><!--[--><!--]--> 1.2 数据库发展阶段 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-3-数据模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.3 数据模型"><!--[--><!--]--> 1.3 数据模型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-4-e-r-图" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.4 E-R 图"><!--[--><!--]--> 1.4 E-R 图 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-5-常用的数据模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.5 常用的数据模型"><!--[--><!--]--> 1.5 常用的数据模型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-6-数据库系统的结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.6 数据库系统的结构"><!--[--><!--]--> 1.6 数据库系统的结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-7-数据库系统的组成" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.7 数据库系统的组成"><!--[--><!--]--> 1.7 数据库系统的组成 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_2-1-概念" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.1 概念"><!--[--><!--]--> 2.1 概念 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_2-2-关系操作" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.2 关系操作"><!--[--><!--]--> 2.2 关系操作 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_2-3-关系语言的分类" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.3 关系语言的分类"><!--[--><!--]--> 2.3 关系语言的分类 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_2-4-关系的完整性" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.4 关系的完整性"><!--[--><!--]--> 2.4 关系的完整性 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-1-基本概念" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.1 基本概念"><!--[--><!--]--> 3.1 基本概念 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-2-sql-语言功能" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.2 SQL 语言功能"><!--[--><!--]--> 3.2 SQL 语言功能 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-3-sql-语言的特点" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.3 SQL 语言的特点"><!--[--><!--]--> 3.3 SQL 语言的特点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-4-sql-语法-上" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.4 SQL 语法（上）"><!--[--><!--]--> 3.4 SQL 语法（上） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-5-sql-语法-中" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.5 SQL 语法（中）"><!--[--><!--]--> 3.5 SQL 语法（中） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-6-sql-语法-下" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.6 SQL 语法（下）"><!--[--><!--]--> 3.6 SQL 语法（下） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-7-创建视图" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.7 创建视图"><!--[--><!--]--> 3.7 创建视图 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_4-1-数据库安全性控制" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.1 数据库安全性控制"><!--[--><!--]--> 4.1 数据库安全性控制 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_4-2-数据库的角色" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.2 数据库的角色"><!--[--><!--]--> 4.2 数据库的角色 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_4-3-其他安全机制" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.3 其他安全机制"><!--[--><!--]--> 4.3 其他安全机制 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_5-1-完整性要求" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.1 完整性要求"><!--[--><!--]--> 5.1 完整性要求 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_5-2-断言" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.2 断言"><!--[--><!--]--> 5.2 断言 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_5-3-触发器" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.3 触发器"><!--[--><!--]--> 5.3 触发器 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_6-1-范式" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.1 范式"><!--[--><!--]--> 6.1 范式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_6-2-依赖" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.2 依赖"><!--[--><!--]--> 6.2 依赖 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_6-3-候选码和超码" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.3 候选码和超码"><!--[--><!--]--> 6.3 候选码和超码 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_6-4-第一范式-1nf" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.4 第一范式：1NF"><!--[--><!--]--> 6.4 第一范式：1NF <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_6-5-第二范式-2nf" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.5 第二范式：2NF"><!--[--><!--]--> 6.5 第二范式：2NF <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_6-6-第三范式-3nf" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.6 第三范式：3NF"><!--[--><!--]--> 6.6 第三范式：3NF <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_6-7-巴斯-科德范式-bcnf" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.7 巴斯-科德范式：BCNF"><!--[--><!--]--> 6.7 巴斯-科德范式：BCNF <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_6-8-第四范式-4nf" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.8 第四范式：4NF"><!--[--><!--]--> 6.8 第四范式：4NF <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_6-9-第五范式-5nf" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.9 第五范式：5NF"><!--[--><!--]--> 6.9 第五范式：5NF <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_6-10-公理系统" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.10 公理系统"><!--[--><!--]--> 6.10 公理系统 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_6-11-求函数最小依赖" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.11 求函数最小依赖"><!--[--><!--]--> 6.11 求函数最小依赖 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_6-12-模式分解" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.12 模式分解"><!--[--><!--]--> 6.12 模式分解 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_7-1-数据库谁的基本步骤" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.1 数据库谁的基本步骤"><!--[--><!--]--> 7.1 数据库谁的基本步骤 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_7-2-e-r-图" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.2 E-R 图"><!--[--><!--]--> 7.2 E-R 图 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_8-1-嵌入式-sql" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.1 嵌入式 SQL"><!--[--><!--]--> 8.1 嵌入式 SQL <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_9-1-查询过程" class="router-link-active router-link-exact-active sidebar-item" aria-label="9.1 查询过程"><!--[--><!--]--> 9.1 查询过程 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_10-1-事务" class="router-link-active router-link-exact-active sidebar-item" aria-label="10.1 事务"><!--[--><!--]--> 10.1 事务 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_10-2-故障" class="router-link-active router-link-exact-active sidebar-item" aria-label="10.2 故障"><!--[--><!--]--> 10.2 故障 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_11-1-概念" class="router-link-active router-link-exact-active sidebar-item" aria-label="11.1 概念"><!--[--><!--]--> 11.1 概念 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_11-2-锁" class="router-link-active router-link-exact-active sidebar-item" aria-label="11.2 锁"><!--[--><!--]--> 11.2 锁 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_11-3-可串行性" class="router-link-active router-link-exact-active sidebar-item" aria-label="11.3 可串行性"><!--[--><!--]--> 11.3 可串行性 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#实验一" class="router-link-active router-link-exact-active sidebar-item" aria-label="实验一"><!--[--><!--]--> 实验一 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#实验二" class="router-link-active router-link-exact-active sidebar-item" aria-label="实验二"><!--[--><!--]--> 实验二 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#实验三" class="router-link-active router-link-exact-active sidebar-item" aria-label="实验三"><!--[--><!--]--> 实验三 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#实验四" class="router-link-active router-link-exact-active sidebar-item" aria-label="实验四"><!--[--><!--]--> 实验四 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-简答题" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. 简答题"><!--[--><!--]--> 1. 简答题 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-1-数据完整性约束" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.1 数据完整性约束"><!--[--><!--]--> 1.1 数据完整性约束 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-2-三级模式结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.2 三级模式结构"><!--[--><!--]--> 1.2 三级模式结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-3-数据库恢复技术" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.3 数据库恢复技术"><!--[--><!--]--> 1.3 数据库恢复技术 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-4-数据库范式" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.4 数据库范式"><!--[--><!--]--> 1.4 数据库范式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-5-数据库并发" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.5 数据库并发"><!--[--><!--]--> 1.5 数据库并发 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_2-设计与计算题" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. 设计与计算题"><!--[--><!--]--> 2. 设计与计算题 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-database-notes/database/#_2-1-关系模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.1 关系模型"><!--[--><!--]--> 2.1 关系模型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_2-2-关系代数" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.2 关系代数"><!--[--><!--]--> 2.2 关系代数 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-综合题" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. 综合题"><!--[--><!--]--> 3. 综合题 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-1-关系代数和-sql" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.1 关系代数和 SQL"><!--[--><!--]--> 3.1 关系代数和 SQL <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-2-候选码" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.2 候选码"><!--[--><!--]--> 3.2 候选码 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-3-事务" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.3 事务"><!--[--><!--]--> 3.3 事务 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_1-简答题-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. 简答题"><!--[--><!--]--> 1. 简答题 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_2-计算题" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. 计算题"><!--[--><!--]--> 2. 计算题 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-database-notes/database/#_2-1-关系代数计算" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.1 关系代数计算"><!--[--><!--]--> 2.1 关系代数计算 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_2-2-概念模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.2 概念模型"><!--[--><!--]--> 2.2 概念模型 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-应用题" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. 应用题"><!--[--><!--]--> 3. 应用题 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-1-关系代数和-sql-编写" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.1 关系代数和 SQL 编写"><!--[--><!--]--> 3.1 关系代数和 SQL 编写 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_3-2-关系的函数依赖和范式" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.2 关系的函数依赖和范式"><!--[--><!--]--> 3.2 关系的函数依赖和范式 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_4-其他相关题目" class="router-link-active router-link-exact-active sidebar-item" aria-label="4. 其他相关题目"><!--[--><!--]--> 4. 其他相关题目 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-database-notes/database/#_4-1-填空题" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.1 填空题"><!--[--><!--]--> 4.1 填空题 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_4-2-关系模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.2 关系模型"><!--[--><!--]--> 4.2 关系模型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_4-3-关系模式" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.3 关系模式"><!--[--><!--]--> 4.3 关系模式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_4-4-并发和故障恢复" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.4 并发和故障恢复"><!--[--><!--]--> 4.4 并发和故障恢复 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_4-5-候选码和最小依赖集" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.5 候选码和最小依赖集"><!--[--><!--]--> 4.5 候选码和最小依赖集 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-database-notes/database/#_4-6-事务调度" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.6 事务调度"><!--[--><!--]--> 4.6 事务调度 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><p>本文是 <a href="https://www.bilibili.com/video/BV1jf4y147jz/" target="_blank" rel="noopener noreferrer"><em>拯救者：数据库系统概论速成</em><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 课程笔记，另外文末还包含实验题的 SQL，测试试卷和答案。</p><h1 id="_1-绪论" tabindex="-1"><a class="header-anchor" href="#_1-绪论" aria-hidden="true">#</a> 1. 绪论</h1><ol><li>了解数据库的四个基本概念</li><li>了解数据库的发展阶段</li><li>了解常见的数据库的数据模型</li><li>了解数据库系统的组成</li></ol><h2 id="_1-1-基本概念" tabindex="-1"><a class="header-anchor" href="#_1-1-基本概念" aria-hidden="true">#</a> 1.1 基本概念</h2><p><strong>数据</strong>：是描述事物的符号记录。</p><p><strong>数据库</strong>：永久储存、有组织、可共享三个基本特点。</p><p>严格来讲，数据库是长期储存在计算机内、有组织、可共享的大量数据的集合。数据库中的数据按一定的数据模型组织、描述和储存，具有较小的冗余度、较高的数据独立性和易扩展性，并可为各种用户共享。</p><p><strong>数据库管理系统</strong>：是位于用户和操作系统之间的一层数据管理软件。</p><p>功能：</p><ol><li>数据定义</li><li>数据组织、存储和管理</li><li>数据操纵</li><li>数据库的事务管理和运行管理</li><li>数据库的建立和维护功能</li><li>其他功能 <ul><li>通信</li><li>数据转换</li><li>互访、互操作</li></ul></li></ol><p><strong>数据库系统</strong>：是由数据库、数据库管理系统（及其应用开发工具）、应用程序和数据库管理员（DBA）组成的储存、管理、处理和维护数据的系统。</p><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><h2 id="_1-2-数据库发展阶段" tabindex="-1"><a class="header-anchor" href="#_1-2-数据库发展阶段" aria-hidden="true">#</a> 1.2 数据库发展阶段</h2><ol><li>人工阶段 <ul><li>数据不保存</li><li>不共享</li><li>不具有独立性</li></ul></li><li>文件系统阶段 <ul><li>可保存</li><li>共享性差</li><li>冗余度差</li><li>独立性差</li></ul></li><li>数据库管理系统 <ul><li>共享性高</li><li>冗余度低</li><li>易扩展</li><li>独立性高 <ul><li>物理的独立性：用户的应用程序与数据库中的数据的物理储存相互独立</li><li>逻辑的独立性：用户的应用程序与数据库的逻辑结构是相互独立的</li></ul></li></ul></li></ol><p>数据库管理系统的出现使信息系统从以 <strong>加工数据为中心</strong> 转向围绕 <strong>共享的数据库</strong> 为中心的新阶段。</p><h2 id="_1-3-数据模型" tabindex="-1"><a class="header-anchor" href="#_1-3-数据模型" aria-hidden="true">#</a> 1.3 数据模型</h2><p>数据模型：</p><ol><li>概念模型 <ul><li>也称为 <strong>信息模型</strong>，它是按用户观点来对数据和信息建模，主要用于数据库的设计</li><li>概念模型的一种表示方法是：<strong>实体 - 联系方法</strong>，用 E-R 图来描述现实世界的概念模型，E-R 方法也称为 E-R 模型</li><li>基本概念： <ul><li><strong>实体</strong>：即对象</li><li><strong>属性</strong>：对象的特征</li><li><strong>码</strong>：具有唯一识别的属性</li><li><strong>实体型</strong>：即类</li><li><strong>实体集</strong>：同一类实体的集合</li><li><strong>联系</strong>：通常指的是不同实体集之间的联系</li></ul></li></ul></li><li>逻辑模型 <ul><li>是按计算机系统的观点对数据建模，主要用于数据库管理系统的实现</li><li>包括： <ol><li>层次模型</li><li>网状模型</li><li>关系模型</li><li>物理模型</li></ol></li><li>是对数据最底层的抽象，它描述数据在系统内部的表示方法和存取方法，或在磁盘或磁带上的储存方式和存取方法，是面向计算机系统的</li></ul></li></ol><p>联系：</p><ul><li>实体之间的联系通常是指不同实体集之间的联系。实体之间的联系有一对一、一对多和多对多等</li><li>实体内部的联系通常是指实体各属性之间的联系</li></ul><h2 id="_1-4-e-r-图" tabindex="-1"><a class="header-anchor" href="#_1-4-e-r-图" aria-hidden="true">#</a> 1.4 E-R 图</h2><div class="hint-container warning"><p class="hint-container-title">注意</p><p>本文使用的 E-R 图是乌鸦脚画法，而教科书上一般使用经典的 Chen 方法，可以相互转换。</p></div><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><p>作为主键的属性下面加上下划线。</p><p>E-R 图分为实体、属性、关系三个核心部分：</p><ul><li>实体是长方形</li><li>属性是椭圆形</li><li>关系为菱形</li></ul><h2 id="_1-5-常用的数据模型" tabindex="-1"><a class="header-anchor" href="#_1-5-常用的数据模型" aria-hidden="true">#</a> 1.5 常用的数据模型</h2><p>模型：</p><ul><li>层次模型</li><li>网状模型</li><li>关系模型</li><li>面向对象模型</li><li>对象关系模型</li><li>半结构化数据模型</li></ul><p><strong>层次模型</strong>：</p><ol><li>有且只有一个根结点</li><li>根以外的其他结点都只有一个父结点</li></ol><ul><li>根结点 <ul><li>R2 <ul><li>R4</li><li>R5</li></ul></li><li>R3</li></ul></li></ul><p><strong>网络模型</strong>：</p><ol><li>允许多个没有父结点的结点</li><li>一个结点可以有多个父结点</li></ol><p><strong>关系模型</strong> 就是一张表：</p><p>学生记录表：</p><table><thead><tr><th style="text-align:right;">学号</th><th style="text-align:center;">姓名</th><th style="text-align:center;">年龄</th><th style="text-align:center;">性别</th><th style="text-align:center;">系名</th><th style="text-align:center;">年级</th></tr></thead><tbody><tr><td style="text-align:right;">2013004</td><td style="text-align:center;">王小明</td><td style="text-align:center;">19</td><td style="text-align:center;">男</td><td style="text-align:center;">社会学</td><td style="text-align:center;">2013</td></tr><tr><td style="text-align:right;">2013006</td><td style="text-align:center;">张文斌</td><td style="text-align:center;">20</td><td style="text-align:center;">女</td><td style="text-align:center;">法律</td><td style="text-align:center;">2013</td></tr></tbody></table><p>表的一些概念：</p><ul><li><strong>关系</strong>：一个关系对应一张表</li><li><strong>元组</strong>：表的一行</li><li><strong>属性</strong>：表的一列</li><li><strong>码</strong>：也称 <strong>码键</strong>，表的某个属性组</li><li><strong>域</strong>：一组具有相同数据类型的值的集合</li><li><strong>分量</strong>：元组中的一个属性</li></ul><h2 id="_1-6-数据库系统的结构" tabindex="-1"><a class="header-anchor" href="#_1-6-数据库系统的结构" aria-hidden="true">#</a> 1.6 数据库系统的结构</h2><p>结构是模式数据库中全体数据的逻辑结构和特征的描述，它仅仅涉及型的描述，不涉及具体的值。其一个具体值称为模式的一个实例。</p><p>模式是相对稳定的，实例是相对变动的。</p><p>三级模式结构：</p><ul><li><strong>外模式</strong><ul><li>也称为 <strong>子模式</strong> 或 <strong>用户模式</strong> 它是数据库用户（包括程序员和最终用户）能够看见和使用的局部数据的逻辑结构和特征的描述，是数据库用户的数据视图，是与某一应用有关的数据的逻辑表示</li></ul></li><li><strong>模式</strong><ul><li>也称为 <strong>逻辑模式</strong>，是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图</li></ul></li><li><strong>内模式</strong><ul><li>也称 <strong>存储模式</strong>，一个数据库只有一个内模式，它是数据物理结构和存储方式的描述，是数据在数据库内部的组织方式</li></ul></li></ul><p>二级映像：</p><ul><li>外模式 / 模式映像：当模式改变时，由数据库管理员对各个外模式 / 模式映像作相应更改，可以使外模式保持不变，应用程序不必修改，保证了数据与程序的逻辑独立性</li><li>内模式 / 模式映像：当数据库的储存结构更改时，由数据库管理员对模式 / 内模式作相应更改，可以使模式保持不变，从而应用程序也不必修改，保证了数据与程序的物理独立性</li></ul><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><p>数据与程序直接的独立性使得数据的定义和描述可以从应用程序中分离出去，另外，由于数据的存取由数据库管理系统管理，从而简化了应用程序的编制，大大减少了应用程序的维护和修改。</p><h2 id="_1-7-数据库系统的组成" tabindex="-1"><a class="header-anchor" href="#_1-7-数据库系统的组成" aria-hidden="true">#</a> 1.7 数据库系统的组成</h2><p>包括：</p><ol><li>硬件平台及数据库：足够大的内存、磁盘或磁盘阵列等设备，较高的通道能力以提高数据的传送率</li><li>软件：数据库管理系统，支持数据库管理系统运行的操作系统，具有与数据库接口的高级语言及其编译系统，以数据库管理系统为核心的应用开发工具，为特定应用环境开发的数据库应用系统</li><li>人员：开发、管理和使用数据库的人员主要包括数据库管理员、系统分析员和数据库设计人员、应用程序员和最终用户</li></ol><p>数据库管理员职责：决定数据库中的信息内容和结构、决定数据库的存储结构和存取策略、定义数据的安全性要求和完整性约束条件、监控数据库的使用和运行、数据库的改进和重组、重构。</p><h1 id="_2-关系型数据库" tabindex="-1"><a class="header-anchor" href="#_2-关系型数据库" aria-hidden="true">#</a> 2. 关系型数据库</h1><ol><li>关系模式</li><li>关系操作</li><li>关系语言的分类</li><li>关系的代数语言</li><li>关系的完整性</li></ol><h2 id="_2-1-概念" tabindex="-1"><a class="header-anchor" href="#_2-1-概念" aria-hidden="true">#</a> 2.1 概念</h2><p>什么是关系？</p><p>关系是一张表。</p><p>关系有哪些需要描述？</p><ul><li>关系中的属性</li><li>这些属性来自于哪些域</li><li>属性与域之间的映射关系</li></ul><p>关系可以表示为</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><mrow><mo fence="true">(</mo><mi>U</mi><mo separator="true">,</mo><mtext> </mtext><mi>D</mi><mo separator="true">,</mo><mtext> </mtext><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">O</mi><mi mathvariant="normal">M</mi></mrow><mo separator="true">,</mo><mtext> </mtext><mi>F</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex"> R\left(U,\, D,\, \mathrm{DOM},\, F\right) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">DOM</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> ：关系名</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> ：所有属性名</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> ：属性来自哪些域</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">O</mi><mi mathvariant="normal">M</mi></mrow><annotation encoding="application/x-tex">\mathrm{DOM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathrm">DOM</span></span></span></span></span> ：属性和域的映射</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> ：属性间的依赖关系</li></ul><p>关系数据库：关系数据库也有关系数据库模式。</p><h2 id="_2-2-关系操作" tabindex="-1"><a class="header-anchor" href="#_2-2-关系操作" aria-hidden="true">#</a> 2.2 关系操作</h2><p>关系操作：</p><ul><li>插入</li><li>查询</li><li>删除</li><li>修改</li></ul><p>查询操作</p><ul><li>选择</li><li>投影</li><li>连接</li><li>除法</li><li>并</li><li>差</li><li>交</li><li>笛卡尔积</li></ul><p>查询操作的基本操作有</p><ul><li>选择</li><li>投影</li><li>并</li><li>差</li><li>笛卡尔积</li></ul><h2 id="_2-3-关系语言的分类" tabindex="-1"><a class="header-anchor" href="#_2-3-关系语言的分类" aria-hidden="true">#</a> 2.3 关系语言的分类</h2><p>分类：</p><ul><li>关系代数语言</li><li>关系演算语言</li><li>SQL 语言</li></ul><p><strong>关系代数语言</strong> 是一种抽象的查询语言，它用对关系的运算来表达查询。</p><p>三大要素：</p><ul><li>运算对象（关系）</li><li>运算符（集合运算符和专门的关系运算符）</li><li>运算结果（关系）</li></ul><p>关系代数的运算符：</p><table><thead><tr><th style="text-align:center;">运算符</th><th style="text-align:center;">含义</th><th style="text-align:center;">类别</th></tr></thead><tbody><tr><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∪</mo></mrow><annotation encoding="application/x-tex">\cup</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∪</span></span></span></span></td><td style="text-align:center;">并</td><td style="text-align:center;">集合运算符</td></tr><tr><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo></mrow><annotation encoding="application/x-tex">-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">−</span></span></span></span></td><td style="text-align:center;">差</td><td style="text-align:center;">集合运算符</td></tr><tr><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∩</mo></mrow><annotation encoding="application/x-tex">\cap</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∩</span></span></span></span></td><td style="text-align:center;">交</td><td style="text-align:center;">集合运算符</td></tr><tr><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>×</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">×</span></span></span></span></td><td style="text-align:center;">笛卡尔积</td><td style="text-align:center;">集合运算符</td></tr><tr><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></td><td style="text-align:center;">选择</td><td style="text-align:center;">专门的关系运算符</td></tr><tr><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Π</mi></mrow><annotation encoding="application/x-tex">\Pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Π</span></span></span></span></td><td style="text-align:center;">投影</td><td style="text-align:center;">专门的关系运算符</td></tr><tr><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋈</mo></mrow><annotation encoding="application/x-tex">\Join</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.51em;vertical-align:-0.005em;"></span><span class="mrel">⋈</span></span></span></span></td><td style="text-align:center;">连接</td><td style="text-align:center;">专门的关系运算符</td></tr><tr><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>÷</mo></mrow><annotation encoding="application/x-tex">\div</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">÷</span></span></span></span></td><td style="text-align:center;">除</td><td style="text-align:center;">专门的关系运算符</td></tr></tbody></table><p>关系代数运算中的基本运算：</p><ul><li>交 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∩</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \cap B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li><li>并 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \cup B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li><li>差 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>−</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A - B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li><li>笛卡尔积 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \times B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li><li>选择 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span>，使用条件表达式</li><li>投影 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Π</mi></mrow><annotation encoding="application/x-tex">\Pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Π</span></span></span></span></li><li>连接 <ul><li>自然连接</li><li>外连接</li><li>左连接</li><li>右连接</li></ul></li></ul><p>条件表达式中的运算符：</p><table><thead><tr><th style="text-align:center;">运算符类型</th><th style="text-align:center;">运算符</th></tr></thead><tbody><tr><td style="text-align:center;">比较运算符</td><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span></span></span></span></td></tr><tr><td style="text-align:center;">比较运算符</td><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo></mrow><annotation encoding="application/x-tex">\ge</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≥</span></span></span></span></td></tr><tr><td style="text-align:center;">比较运算符</td><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo></mrow><annotation encoding="application/x-tex">&lt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span></span></span></span></td></tr><tr><td style="text-align:center;">比较运算符</td><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo></mrow><annotation encoding="application/x-tex">\le</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span></span></span></span></td></tr><tr><td style="text-align:center;">比较运算符</td><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span></span></span></span></td></tr><tr><td style="text-align:center;">比较运算符</td><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo mathvariant="normal">≠</mo></mrow><annotation encoding="application/x-tex">\neq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span></span></span></span></td></tr><tr><td style="text-align:center;">逻辑运算符</td><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">¬</mi></mrow><annotation encoding="application/x-tex">\neg</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord">¬</span></span></span></span></td></tr><tr><td style="text-align:center;">逻辑运算符</td><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∨</mo></mrow><annotation encoding="application/x-tex">\vee</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∨</span></span></span></span></td></tr><tr><td style="text-align:center;">逻辑运算符</td><td style="text-align:center;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∧</mo></mrow><annotation encoding="application/x-tex">\wedge</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∧</span></span></span></span></td></tr></tbody></table><table><thead><tr><th style="text-align:right;">Sno</th><th style="text-align:center;">Sname</th><th style="text-align:center;">Ssex</th><th style="text-align:center;">Sage</th><th style="text-align:center;">Sdept</th></tr></thead><tbody><tr><td style="text-align:right;">201215125</td><td style="text-align:center;">张立</td><td style="text-align:center;">男</td><td style="text-align:center;">19</td><td style="text-align:center;">IS</td></tr></tbody></table><p>查询表达式</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>σ</mi><mrow><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">t</mi></mrow><mo>=</mo><mtext>‘Is’</mtext></mrow></msub><mo stretchy="false">(</mo><mtext>Student</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> \sigma_{\mathrm{Sdept}=\text{‘Is’}}(\text{Student}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">Sdept</span></span><span class="mrel mtight">=</span><span class="mord text mtight"><span class="mord mtight">‘Is’</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">Student</span></span><span class="mclose">)</span></span></span></span></span></p><p>查找学生的年龄和姓名</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mo separator="true">,</mo><mtext> </mtext><mi mathvariant="normal">S</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">e</mi></mrow></msub><mo stretchy="false">(</mo><mtext>Student</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> \Pi_{\mathrm{Sname,\,Sage}}(\text{Student}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">Sname</span><span class="mpunct mtight">,</span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathrm mtight">Sage</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">Student</span></span><span class="mclose">)</span></span></span></span></span></p><p>查找学号为 <code>201215125</code> 的学生的年龄和姓名</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mo separator="true">,</mo><mtext> </mtext><mi mathvariant="normal">S</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">e</mi></mrow></msub><mrow><mo fence="true">(</mo><msub><mi>σ</mi><mrow><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi></mrow><mo>=</mo><mtext>201215125</mtext></mrow></msub><mo stretchy="false">(</mo><mtext>Student</mtext><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \Pi_{\mathrm{Sname,\,Sage}}\left( \sigma_{\mathrm{Sno}=\text{201215125}}(\text{Student}) \right) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">Sname</span><span class="mpunct mtight">,</span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathrm mtight">Sage</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">Sno</span></span><span class="mrel mtight">=</span><span class="mord text mtight"><span class="mord mtight">201215125</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">Student</span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p><strong>自然连接</strong>，选取公共属性</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">R=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span></p><table><thead><tr><th>A</th><th>B</th><th>C</th><th>D</th></tr></thead><tbody><tr><td>m</td><td>1</td><td>n</td><td>a</td></tr><tr><td>n</td><td>4</td><td>m</td><td>b</td></tr><tr><td>p</td><td>1</td><td>p</td><td>a</td></tr><tr><td>q</td><td>2</td><td>q</td><td>b</td></tr></tbody></table><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">S=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span></p><table><thead><tr><th>B</th><th>D</th><th>E</th></tr></thead><tbody><tr><td>1</td><td>a</td><td>d</td></tr><tr><td>3</td><td>a</td><td>f</td></tr><tr><td>1</td><td>a</td><td>g</td></tr><tr><td>2</td><td>b</td><td>h</td></tr><tr><td>3</td><td>b</td><td>j</td></tr></tbody></table><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>⋈</mo><mi>S</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">R \Join S =</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6883em;vertical-align:-0.005em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span></p><table><thead><tr><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th></tr></thead><tbody><tr><td>m</td><td>1</td><td>n</td><td>a</td><td>d</td></tr><tr><td>m</td><td>1</td><td>n</td><td>a</td><td>g</td></tr><tr><td>p</td><td>1</td><td>p</td><td>a</td><td>d</td></tr><tr><td>p</td><td>1</td><td>p</td><td>a</td><td>g</td></tr><tr><td>q</td><td>2</td><td>q</td><td>b</td><td>h</td></tr></tbody></table><p><strong>悬浮元素</strong>：关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 与 关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> 在作自然连接时，关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 中某些元组有可能不存在公共属性上值相等的元组，从而造成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 中这些元组在操作时被舍弃了，这些被舍弃的元组称为悬浮元组。</p><p>外连接：</p><ul><li><strong>外连接</strong>：把悬浮元组也保存在关系中，其他属性上填空值 <code>NULL</code></li><li><strong>左连接</strong>：保留关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 中的悬浮元组</li><li><strong>右连接</strong>：保留关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> 中的悬浮元组</li></ul><p><strong>除</strong>：保留 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 中满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> 的，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 中的列去掉 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> 的列。</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">R=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span></p><table><thead><tr><th style="text-align:center;">姓名</th><th style="text-align:center;">选修课程</th></tr></thead><tbody><tr><td style="text-align:center;">张三</td><td style="text-align:center;">计算机</td></tr><tr><td style="text-align:center;">张三</td><td style="text-align:center;">数据库</td></tr><tr><td style="text-align:center;">张三</td><td style="text-align:center;">网络</td></tr><tr><td style="text-align:center;">李四</td><td style="text-align:center;">网络</td></tr><tr><td style="text-align:center;">李四</td><td style="text-align:center;">计算机</td></tr><tr><td style="text-align:center;">王五</td><td style="text-align:center;">数据库</td></tr><tr><td style="text-align:center;">王五</td><td style="text-align:center;">网络</td></tr></tbody></table><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">S=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span></p><table><thead><tr><th style="text-align:center;">选修课程</th></tr></thead><tbody><tr><td style="text-align:center;">数据库</td></tr><tr><td style="text-align:center;">网络</td></tr></tbody></table><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>÷</mo><mi>S</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">R \div S =</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">÷</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span></p><table><thead><tr><th style="text-align:center;">姓名</th></tr></thead><tbody><tr><td style="text-align:center;">张三</td></tr><tr><td style="text-align:center;">王五</td></tr></tbody></table><h2 id="_2-4-关系的完整性" tabindex="-1"><a class="header-anchor" href="#_2-4-关系的完整性" aria-hidden="true">#</a> 2.4 关系的完整性</h2><ol><li>实体完整性 <ul><li>主码唯一且非空</li></ul></li><li>参照完整性 <ul><li>外码要么为空，要么对应另一个表的主码</li></ul></li><li>用户定义完整性 <ul><li>自定义的完整性</li></ul></li></ol><h1 id="_3-sql-语言" tabindex="-1"><a class="header-anchor" href="#_3-sql-语言" aria-hidden="true">#</a> 3. SQL 语言</h1><ol><li>SQL 概念</li><li>SQL 语法</li></ol><h2 id="_3-1-基本概念" tabindex="-1"><a class="header-anchor" href="#_3-1-基本概念" aria-hidden="true">#</a> 3.1 基本概念</h2><p><strong>结构化数据查询语言</strong>（SQL, Structured Query Language）是一种在数据库管理系统中查询或对数据库里面的数据进行更改的语言。</p><p>数据库管理系统主要有：</p><ul><li>关系型 <ul><li>MySQL</li><li>Oracle</li><li>PostgreSQL</li><li>SQL Server</li></ul></li><li>非关系型 <ul><li>Redis</li><li>MongoDB</li></ul></li></ul><p>不同的数据库管理系统的 SQL 略有不同。</p><h2 id="_3-2-sql-语言功能" tabindex="-1"><a class="header-anchor" href="#_3-2-sql-语言功能" aria-hidden="true">#</a> 3.2 SQL 语言功能</h2><p>SQL <strong>数据定义语言</strong>（DDL, Data Definition Language）主要用来定义逻辑结构，包括定义基表，视图和索引。</p><p>数据定义语言：</p><ul><li>删除表</li><li>定义表</li><li>修改表</li></ul><p>SQL <strong>数据查询语言</strong>（DQL, Data Query Language）对数据库各种数据进行查询。</p><p>SQL <strong>数据操纵语言</strong>（DML, Data Manipulation Language）改变数据库中的数据，包括插入，删除，修改。</p><p>SQL <strong>数据控制语言</strong>（DCL, Data Control Language）对表和视图授权，完整性规则的描述以及事务开始和结束等控制语句。</p><h2 id="_3-3-sql-语言的特点" tabindex="-1"><a class="header-anchor" href="#_3-3-sql-语言的特点" aria-hidden="true">#</a> 3.3 SQL 语言的特点</h2><p>特点：</p><ol><li>综合统一，即独立完成数据库生命周期全部活动 <ul><li>定义关系模式</li><li>录入数据</li><li>建立数据库</li><li>查询</li><li>更新</li><li>维护</li><li>重构</li></ul></li><li>高度非过程化 <ul><li>用户只需要写做什么</li><li>不需要写怎么做</li></ul></li><li>面向集合的操作方式 <ul><li>SQL 采用集合操作的方式</li></ul></li><li>以同一种语法结构提供两种使用方式 <ul><li>SQL 是自含式语言</li><li>SQL 也是嵌入式语言，可以嵌入到高级程序语言中</li></ul></li><li>语言简单，易学易用 <ul><li>语法简单</li><li>接近英语口语</li></ul></li></ol><h2 id="_3-4-sql-语法-上" tabindex="-1"><a class="header-anchor" href="#_3-4-sql-语法-上" aria-hidden="true">#</a> 3.4 SQL 语法（上）</h2><p>数据类型</p><table><thead><tr><th style="text-align:left;">数据类型</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;"><code>char(n) character(n)</code></td><td style="text-align:left;">定长字符串</td></tr><tr><td style="text-align:left;"><code>varchar(n) charactervarying(n)</code></td><td style="text-align:left;">最大长度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 的变长字符串</td></tr><tr><td style="text-align:left;"><code>clob</code></td><td style="text-align:left;">长字符串</td></tr><tr><td style="text-align:left;"><code>blob</code></td><td style="text-align:left;">二进制大对象</td></tr><tr><td style="text-align:left;"><code>int, integer</code></td><td style="text-align:left;">整数（4 字节）</td></tr><tr><td style="text-align:left;"><code>smallint</code></td><td style="text-align:left;">短整数（2 字节）</td></tr><tr><td style="text-align:left;"><code>bigint</code></td><td style="text-align:left;">大整数（8 字节）</td></tr><tr><td style="text-align:left;"><code>numeric(p, d)</code></td><td style="text-align:left;">定点数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> 位数字，小数点后有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span> 位</td></tr><tr><td style="text-align:left;"><code>dec(p, d) decimal(p, d)</code></td><td style="text-align:left;">定点数，同 <code>numeric</code></td></tr><tr><td style="text-align:left;"><code>real</code></td><td style="text-align:left;">单精度</td></tr><tr><td style="text-align:left;"><code>double</code></td><td style="text-align:left;">双精度</td></tr><tr><td style="text-align:left;"><code>float(n)</code></td><td style="text-align:left;">精度至少 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 位数字的浮点数</td></tr><tr><td style="text-align:left;"><code>boolean</code></td><td style="text-align:left;">逻辑变量</td></tr><tr><td style="text-align:left;"><code>time</code></td><td style="text-align:left;">HH:MM:SS</td></tr><tr><td style="text-align:left;"><code>date</code></td><td style="text-align:left;">YYYY-MM-DD</td></tr><tr><td style="text-align:left;"><code>timestamp</code></td><td style="text-align:left;">时间戳类型</td></tr><tr><td style="text-align:left;"><code>interval</code></td><td style="text-align:left;">时间间隔</td></tr></tbody></table><p>模式的定义和删除：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">schema</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span> <span class="token keyword">authorization</span> <span class="token operator">&lt;</span><span class="token keyword">user</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>参数：</p><ul><li><code>&lt;name&gt;</code> 模式名</li><li><code>&lt;user&gt;</code> 用户名</li></ul><p>例如，为用户 WANG 定义一个学生 - 课程模式 S-T：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">schema</span> <span class="token string">&#39;S-T&#39;</span> <span class="token keyword">authorization</span> WANG<span class="token punctuation">;</span>
</code></pre></div><p>模式定义 + 视图：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">schema</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span> <span class="token keyword">authorization</span> <span class="token operator">&lt;</span><span class="token keyword">user</span><span class="token operator">&gt;</span>
<span class="token punctuation">[</span><span class="token operator">&lt;</span>表定义子句<span class="token operator">&gt;</span><span class="token operator">|</span><span class="token operator">&lt;</span>视图定义子句<span class="token operator">&gt;</span><span class="token operator">|</span><span class="token operator">&lt;</span>授权定义子句<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>例如：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">schema</span> <span class="token string">&#39;Learn&#39;</span> <span class="token keyword">authorization</span> alex <span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">user</span><span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
    age <span class="token keyword">int</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>模式删除：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">schema</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span> <span class="token keyword">cascade</span><span class="token operator">|</span><span class="token keyword">restrict</span><span class="token punctuation">;</span>
</code></pre></div><p><code>cascade</code> 与 <code>restrict</code> 必须二选一：</p><ul><li><code>cascade</code> 级联，把该模式下的数据库也删除</li><li><code>restrict</code> 限制模式，如果该模式下有下属对象，比如表视图，就就拒绝这个语句执行</li></ul><p>创建表：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>表名称<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>字段名<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>类型<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>字段约束<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>比如：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">user</span><span class="token punctuation">(</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    age <span class="token keyword">int</span><span class="token punctuation">,</span>
    sex <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>删除表：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token keyword">cascade</span><span class="token operator">|</span><span class="token keyword">restrict</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>如果是 <code>cascade</code>，那么表有外键、视图、触发器也会被删除。</p><p>修改表：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span>
    <span class="token punctuation">[</span><span class="token keyword">add</span> <span class="token punctuation">[</span><span class="token keyword">column</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span>新列名<span class="token operator">&gt;</span><span class="token operator">&lt;</span>数据类型<span class="token operator">&gt;</span><span class="token punctuation">[</span>完整性约束<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token keyword">add</span> <span class="token operator">&lt;</span>表级完整性约束<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>当数据量比较大的时候，查询耗时间长，建立索引可以有效减少时间消耗，索引可以建立在一列或多列上。</p><p>索引的建立和修改：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token punctuation">[</span><span class="token keyword">unique</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>cluster<span class="token punctuation">]</span> <span class="token keyword">index</span> <span class="token operator">&lt;</span>索引名<span class="token operator">&gt;</span> <span class="token keyword">on</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>列名<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>次序<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>含义：</p><ul><li><code>cluster</code> 聚簇索引，物理顺序与索引的逻辑顺序相同</li><li><code>unique</code> 唯一索引</li></ul><p>修改索引：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">index</span> <span class="token operator">&lt;</span>旧索引名<span class="token operator">&gt;</span> <span class="token keyword">rename</span> <span class="token keyword">to</span> <span class="token operator">&lt;</span>新索引名<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>删除索引：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span><span class="token keyword">table</span><span class="token operator">&gt;</span> <span class="token keyword">drop</span> <span class="token keyword">index</span> <span class="token operator">&lt;</span>索引名<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_3-5-sql-语法-中" tabindex="-1"><a class="header-anchor" href="#_3-5-sql-语法-中" aria-hidden="true">#</a> 3.5 SQL 语法（中）</h2><p>选择语句，选择所有：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>列或表起别名：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> title <span class="token keyword">as</span> 课程 <span class="token keyword">from</span> course <span class="token keyword">as</span> ec<span class="token punctuation">;</span>
</code></pre></div><p>结果去重：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">distinct</span> title <span class="token keyword">as</span> 课程 <span class="token keyword">from</span> course<span class="token punctuation">;</span>
</code></pre></div><p><code>distinct</code> 通常效率较低。它不适合用来展示去重后具体的值，一般与 <code>count</code> 配合用来计算条数，例如：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> task_id<span class="token punctuation">)</span> task_num <span class="token keyword">from</span> Task<span class="token punctuation">;</span>
</code></pre></div><p><code>distinct</code> 使用中，放在 <code>select</code> 后边，对后面所有的字段的值统一进行去重。比如 <code>distinct</code> 后面有两个字段，那么 <code>1,1</code> 和 <code>1,2</code> 这两条记录不是重复值。</p><p>查询条件：</p><table><thead><tr><th style="text-align:center;">条件类型</th><th style="text-align:center;">谓词</th></tr></thead><tbody><tr><td style="text-align:center;">比较</td><td style="text-align:center;"><code>= &gt; &lt; &gt;= &lt;= != &lt;&gt; !&gt; !&lt;</code> 或 <code>not</code> 加上前面的比较符号</td></tr><tr><td style="text-align:center;">范围</td><td style="text-align:center;"><code>between ... and ..., not between ... and ...</code></td></tr><tr><td style="text-align:center;">确定集合</td><td style="text-align:center;"><code>in, not in</code></td></tr><tr><td style="text-align:center;">字符匹配</td><td style="text-align:center;"><code>like, not like</code></td></tr><tr><td style="text-align:center;">空值</td><td style="text-align:center;"><code>is null, is not null</code></td></tr><tr><td style="text-align:center;">多重条件</td><td style="text-align:center;"><code>and, or, not</code></td></tr></tbody></table><p>条件子句：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> title <span class="token keyword">from</span> course
    <span class="token keyword">where</span> price <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre></div><p><code>like</code> 子句中，<code>&#39;%&#39;</code> 可以代替多个字符，而 <code>&#39;_&#39;</code> 只能代替一个，例如 <code>like &#39;test%&#39;</code>。</p><p>聚集函数：</p><table><thead><tr><th style="text-align:center;">函数</th><th style="text-align:center;">功能</th></tr></thead><tbody><tr><td style="text-align:center;"><code>count(*)</code></td><td style="text-align:center;">元组的个数</td></tr><tr><td style="text-align:center;"><code>count([distinct│all] &lt;列名&gt;)</code></td><td style="text-align:center;">列中值的个数，可去重</td></tr><tr><td style="text-align:center;"><code>sum([distinct│all] &lt;列名&gt;)</code></td><td style="text-align:center;">求和</td></tr><tr><td style="text-align:center;"><code>avg([distinct│all] &lt;列名&gt;)</code></td><td style="text-align:center;">平均数</td></tr><tr><td style="text-align:center;"><code>max([distinct│all] &lt;列名&gt;)</code></td><td style="text-align:center;">最大值</td></tr><tr><td style="text-align:center;"><code>min([distinct│all] &lt;列名&gt;)</code></td><td style="text-align:center;">最小值</td></tr></tbody></table><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> teacher_id<span class="token punctuation">)</span> <span class="token keyword">from</span> course<span class="token punctuation">;</span>
</code></pre></div><p>分组查询：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> teacher_id <span class="token keyword">from</span> course
    <span class="token keyword">group</span> <span class="token keyword">by</span> teacher_id
    <span class="token keyword">having</span> teacher_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p>可以使用 <code>having</code> 关键字进行筛选。</p><p>连接，相当于笛卡尔积：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> m_blog<span class="token punctuation">,</span> m_user
    <span class="token keyword">where</span> m_blog<span class="token punctuation">.</span>user_id <span class="token operator">=</span> m_user<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre></div><p>自身连接：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> m_blog <span class="token keyword">as</span> m1<span class="token punctuation">,</span> m_blog <span class="token keyword">as</span> m2
    <span class="token keyword">where</span> m1<span class="token punctuation">.</span>id <span class="token operator">=</span> m2<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre></div><p>外连接：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> m_ques mq
    <span class="token keyword">left</span> <span class="token keyword">join</span> m_user mu <span class="token keyword">on</span> mq<span class="token punctuation">.</span>id <span class="token operator">=</span> mu<span class="token punctuation">.</span>id
    <span class="token keyword">limit</span> <span class="token number">100</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> m_ques mq
    <span class="token keyword">right</span> <span class="token keyword">join</span> m_user mu <span class="token keyword">on</span> mq<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>index<span class="token punctuation">`</span></span> <span class="token operator">=</span> mu<span class="token punctuation">.</span>id
    <span class="token keyword">where</span> mq<span class="token punctuation">.</span><span class="token keyword">index</span> <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span>
</code></pre></div><p>多表查询和子查询：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> m_ques <span class="token keyword">as</span> mq
    <span class="token keyword">where</span> mq<span class="token punctuation">.</span>id <span class="token operator">in</span> <span class="token punctuation">(</span>
        <span class="token keyword">select</span> id <span class="token keyword">from</span> m_user<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>带有 <code>any all some</code> 的子查询：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> m_ques <span class="token keyword">as</span> mq
    <span class="token keyword">where</span> mq<span class="token punctuation">.</span>id <span class="token operator">&lt;</span><span class="token keyword">all</span> <span class="token punctuation">(</span>
        <span class="token keyword">select</span> id <span class="token keyword">from</span> m_user <span class="token keyword">where</span> id <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>任意比较符号可以加上 <code>any</code> 或 <code>or</code>。</p><p><code>exists</code> 可以检查子查询是否有可返回的值，返回布尔值。</p><p>并集：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> m_ques
    <span class="token keyword">where</span> m_ques<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>index<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">union</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> m_ques
    <span class="token keyword">where</span> m_ques<span class="token punctuation">.</span>line <span class="token operator">=</span> <span class="token number">2</span>
</code></pre></div><blockquote><p>将 <code>union</code> 换为 <code>intersect</code> 即可变为交集，换为 <code>excpt</code> 即为差集。MySQL 不支持交集 <code>intersect</code> 和差集 <code>excpt</code>。</p></blockquote><h2 id="_3-6-sql-语法-下" tabindex="-1"><a class="header-anchor" href="#_3-6-sql-语法-下" aria-hidden="true">#</a> 3.6 SQL 语法（下）</h2><p>插入数据：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>cols<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token keyword">values</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>批量插入数据：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span> <span class="token keyword">values</span>
    <span class="token punctuation">(</span>cols<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre></div><p>修改：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">update</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span> <span class="token keyword">set</span> col1 <span class="token operator">=</span> val1<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">[</span><span class="token keyword">where</span> <span class="token operator">&lt;</span>条件<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>删除：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">delete</span> <span class="token keyword">from</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span>
    <span class="token punctuation">[</span><span class="token keyword">where</span> <span class="token operator">&lt;</span>条件<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_3-7-创建视图" tabindex="-1"><a class="header-anchor" href="#_3-7-创建视图" aria-hidden="true">#</a> 3.7 创建视图</h2><p>什么是视图？</p><p><strong>视图</strong> 也称为 <strong>虚表</strong>，是一组数据的逻辑表示，其本质是对应一条 <code>select</code> 语句，结果集被赋予一个名字，即视图的名字。</p><p>视图本身不包含任何数据，它只包含映射到基表的一个查询语句，当基表数据发生变化时，视图也随之变化。</p><p>目的：方便、简化数据操作。当我们业务需求要查多张表的数据，这时我们可能会关联多张表的查询处理。如果这个查询 SQL 复杂的话也影响了查询效率。</p><p>这个时候我们可以创建视图，查询的时候只需要</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">view</span><span class="token punctuation">;</span>
</code></pre></div><p>即可。</p><p>创建语法：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">view</span> <span class="token operator">&lt;</span>视图名<span class="token operator">&gt;</span> <span class="token punctuation">[</span>cols<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
    <span class="token keyword">as</span> <span class="token operator">&lt;</span>子查询<span class="token operator">&gt;</span>
    <span class="token punctuation">[</span><span class="token keyword">with</span> <span class="token keyword">check</span> <span class="token keyword">option</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p><code>with check option</code> 将保证更新、插入、删除操作时被操作的行满足视图中的条件。</p><p>删除视图：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">view</span> <span class="token operator">&lt;</span>视图名<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token keyword">cascade</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p><code>cascade</code> 将定义为级联删除，由此视图产生的视图也会被删除。</p><p>更新视图语句：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">update</span> <span class="token operator">&lt;</span>视图名<span class="token operator">&gt;</span> <span class="token keyword">set</span> col1 <span class="token operator">=</span> val1<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">[</span><span class="token keyword">where</span> <span class="token operator">&lt;</span>条件<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>将映射为实际对表的操作。</p><h1 id="_4-数据库的安全性" tabindex="-1"><a class="header-anchor" href="#_4-数据库的安全性" aria-hidden="true">#</a> 4. 数据库的安全性</h1><ol><li>权限控制</li><li>角色</li><li>其他安全机制</li></ol><h2 id="_4-1-数据库安全性控制" tabindex="-1"><a class="header-anchor" href="#_4-1-数据库安全性控制" aria-hidden="true">#</a> 4.1 数据库安全性控制</h2><p>不安全因素：</p><ol><li>非授权对数据库的恶意存取和破坏</li><li>数据库中重要的数据泄露</li><li>安全环境的脆弱性</li></ol><p>自主存取控制方法：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- grant</span>
<span class="token keyword">grant</span> <span class="token operator">&lt;</span>权限<span class="token operator">&gt;</span> <span class="token keyword">on</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span> <span class="token keyword">to</span> <span class="token operator">&lt;</span>用户<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token comment">-- revoke</span>
<span class="token keyword">revoke</span> <span class="token operator">&lt;</span>权限<span class="token operator">&gt;</span> <span class="token keyword">on</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span> <span class="token keyword">from</span> <span class="token operator">&lt;</span>用户<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>数据库安全控制：</p><ol><li>用户身份鉴别 <ul><li>静态口令鉴别</li><li>动态口令鉴别</li><li>生物特征识别</li><li>智能卡识别</li></ul></li><li>存取控制</li><li>自主存取控制方法 <ul><li>即自定义和分配其他用户的权限 <ul><li><code>grant</code> 授予权限</li><li><code>revoke</code> 撤回权限</li></ul></li><li>构成元素有 <strong>数据库对象</strong> 和 <strong>操作权限</strong></li></ul></li></ol><table><thead><tr><th style="text-align:center;">对象类型</th><th style="text-align:center;">对象</th><th style="text-align:left;">操作类型</th></tr></thead><tbody><tr><td style="text-align:center;">数据库模式</td><td style="text-align:center;">模式</td><td style="text-align:left;"><code>create schema</code></td></tr><tr><td style="text-align:center;">数据库模式</td><td style="text-align:center;">基本表</td><td style="text-align:left;"><code>create table, alter table</code></td></tr><tr><td style="text-align:center;">数据库模式</td><td style="text-align:center;">视图</td><td style="text-align:left;"><code>create view</code></td></tr><tr><td style="text-align:center;">数据库模式</td><td style="text-align:center;">索引</td><td style="text-align:left;"><code>create index</code></td></tr><tr><td style="text-align:center;">数据</td><td style="text-align:center;">基本表和视图</td><td style="text-align:left;"><code>select, insert, update, delete, references, all privileges</code></td></tr><tr><td style="text-align:center;">数据</td><td style="text-align:center;">属性列</td><td style="text-align:left;"><code>select, insert, update, references, all privileges</code></td></tr></tbody></table><p>授予用户对一个表的查询权限：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">grant</span> <span class="token keyword">select</span> <span class="token keyword">on</span> student <span class="token keyword">to</span> user1 <span class="token keyword">with</span> <span class="token keyword">grant</span> <span class="token keyword">option</span><span class="token punctuation">;</span>
</code></pre></div><p><code>with grant option</code> 可以使这个用户将自己的权限授予给其他用户。</p><p>回收权限:</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">revoke</span> <span class="token keyword">select</span> <span class="token keyword">on</span> student <span class="token keyword">from</span> user1 <span class="token keyword">cascade</span><span class="token punctuation">;</span>
</code></pre></div><p><code>cascade</code> 级联将撤销其他相关用户的权限，如果其他用户的权限来自这个用户。</p><h2 id="_4-2-数据库的角色" tabindex="-1"><a class="header-anchor" href="#_4-2-数据库的角色" aria-hidden="true">#</a> 4.2 数据库的角色</h2><p>角色指的是一类人，比如 CEO、总监、普通职员，可以给一类人授权。</p><p>创建角色：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> role <span class="token operator">&lt;</span>角色名<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>角色权限：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">grant</span> <span class="token operator">&lt;</span>权限<span class="token operator">&gt;</span> <span class="token keyword">on</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>对象类型<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span>对象名<span class="token operator">&gt;</span> <span class="token keyword">to</span> <span class="token operator">&lt;</span>角色<span class="token number">1</span><span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> role CEO<span class="token punctuation">;</span>

<span class="token keyword">grant</span> <span class="token keyword">select</span> <span class="token keyword">on</span> Student <span class="token keyword">to</span> CEO<span class="token punctuation">;</span>
</code></pre></div><p>将角色赋给用户或角色：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">grant</span> CEO <span class="token keyword">to</span> user1 <span class="token keyword">with</span> admin <span class="token keyword">option</span><span class="token punctuation">;</span>
</code></pre></div><p><code>with admin option</code> 意味着这个用户可以将权限赋给别的用户。</p><p>收回角色权限：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">revoke</span> <span class="token keyword">select</span> <span class="token keyword">on</span> Student <span class="token keyword">from</span> CEO<span class="token punctuation">;</span>
</code></pre></div><p>使用视图提供保护机制：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">view</span> CS_Student <span class="token keyword">as</span>
    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> Student
        <span class="token keyword">where</span> sdept <span class="token operator">=</span> <span class="token string">&#39;IS&#39;</span>
    <span class="token keyword">with</span> <span class="token keyword">check</span> <span class="token keyword">option</span><span class="token punctuation">;</span>

<span class="token keyword">grant</span> <span class="token keyword">select</span> <span class="token keyword">on</span> CS_Student <span class="token keyword">to</span> user1<span class="token punctuation">;</span>

<span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">privileges</span> <span class="token keyword">on</span> CS_Student <span class="token keyword">to</span> user1<span class="token punctuation">;</span>
</code></pre></div><h2 id="_4-3-其他安全机制" tabindex="-1"><a class="header-anchor" href="#_4-3-其他安全机制" aria-hidden="true">#</a> 4.3 其他安全机制</h2><p><strong>审计</strong>：将数据库所有操作记录到审计日志中，然后可以通过日志查看非法行为。</p><p>对修改 <code>&#39;SC&#39;</code> 的操作进行审计：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code>audit <span class="token keyword">update</span> <span class="token keyword">on</span> SC<span class="token punctuation">;</span>
</code></pre></div><p>取消对 <code>&#39;SC&#39;</code> 表的审计：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code>noaudit <span class="token keyword">update</span> <span class="token keyword">on</span> SC<span class="token punctuation">;</span>
</code></pre></div><p><strong>数据加密</strong>：通过一些加密算法，把明文变成密文，这样别人无法查看。</p><h1 id="_5-数据库的完整性" tabindex="-1"><a class="header-anchor" href="#_5-数据库的完整性" aria-hidden="true">#</a> 5. 数据库的完整性</h1><ol><li>数据库的安全性</li><li>数据库的完整性</li><li>掌握断言和触发器的使用</li></ol><h2 id="_5-1-完整性要求" tabindex="-1"><a class="header-anchor" href="#_5-1-完整性要求" aria-hidden="true">#</a> 5.1 完整性要求</h2><p>数据库的完整性：</p><ul><li>正确性：符合现实世界描述</li><li>相容性：同一对象在不同表里面是符合逻辑的</li><li>维护完整性 <ol><li>提供完整性约束条件的机制</li><li>提供完整性的检查方法</li><li>进行违约处理</li></ol></li><li>三大完整性 <ol><li>实体完整性：主码唯一且非空</li><li>参照完整性：外码要么没有，要么只有一个</li><li>用户定义完整性 <ul><li>非空 <code>not null</code></li><li>列值唯一 <code>unique</code></li><li>条件表达式 <code>check in (&#39;男&#39;, &#39;女&#39;)</code></li></ul></li></ol></li></ul><p>比如下面这个表：</p><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>m_user<span class="token punctuation">`</span></span>  <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>avatar<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>email<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>created<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>last_login<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">using</span> <span class="token keyword">BTree</span><span class="token punctuation">,</span>
  <span class="token keyword">index</span> <span class="token identifier"><span class="token punctuation">`</span>uk_username<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token keyword">asc</span><span class="token punctuation">)</span> <span class="token keyword">using</span> <span class="token keyword">BTree</span>
<span class="token punctuation">)</span> <span class="token keyword">engine</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-2-断言" tabindex="-1"><a class="header-anchor" href="#_5-2-断言" aria-hidden="true">#</a> 5.2 断言</h2><p>断言的建立：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> assertion <span class="token operator">&lt;</span>断言名<span class="token operator">&gt;</span>
    <span class="token keyword">check</span> <span class="token operator">&lt;</span>子句<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>例如，限制每一门课程最多 60 名学生选修：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> assertion ASSE_SC_CNUM
    <span class="token keyword">check</span> <span class="token punctuation">(</span><span class="token number">60</span> <span class="token operator">&gt;=</span> <span class="token keyword">all</span> <span class="token punctuation">(</span>
        <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> sc
           <span class="token keyword">group</span> <span class="token keyword">by</span> cno
    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>删除断言：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">drop</span> assertion <span class="token operator">&lt;</span>断言名<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_5-3-触发器" tabindex="-1"><a class="header-anchor" href="#_5-3-触发器" aria-hidden="true">#</a> 5.3 触发器</h2><p>触发器是 <strong>事件 -&gt; 条件 -&gt; 动作</strong> 的规则。</p><p>当对一个表增、删、改的时候，对触发器里面的条件进行执行，如果成立则执行触发器的动作。</p><p>触发器的建立：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">trigger</span> <span class="token operator">&lt;</span>触发器名<span class="token operator">&gt;</span>
    before<span class="token operator">|</span><span class="token keyword">after</span> <span class="token operator">&lt;</span>触发事件<span class="token operator">&gt;</span> <span class="token keyword">on</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span>
    <span class="token punctuation">[</span>referencing
        old <span class="token keyword">as</span> <span class="token operator">&lt;</span>变量<span class="token operator">&gt;</span><span class="token punctuation">,</span>
        new <span class="token keyword">as</span> <span class="token operator">&lt;</span>变量<span class="token operator">&gt;</span><span class="token punctuation">]</span>
    <span class="token keyword">for each row</span><span class="token operator">|</span>statement
        <span class="token punctuation">[</span><span class="token keyword">when</span> <span class="token operator">&lt;</span>触发条件<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token operator">&lt;</span>触发动作<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p><code>row</code> 是每改变一行触发一次，<code>statement</code> 是每个语句触发一次。</p><p>如果修改表的属性，那么将此操作记录到另一个表：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">trigger</span> SC_T
    <span class="token keyword">after</span> UPDATE_OF_GRADE <span class="token keyword">on</span> SC
    referencing
        oldrow <span class="token keyword">as</span> oldtuple<span class="token punctuation">,</span>
        newrow <span class="token keyword">as</span> newtuple
    <span class="token keyword">for each row</span>
        <span class="token keyword">when</span> <span class="token punctuation">(</span>newtuple<span class="token punctuation">.</span>grade <span class="token operator">&gt;=</span> <span class="token number">1.1</span> <span class="token operator">*</span> oldtuple<span class="token punctuation">.</span>grade<span class="token punctuation">)</span>
            <span class="token keyword">insert</span> <span class="token keyword">into</span> SC_U <span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> oldgrade<span class="token punctuation">,</span> newgrade<span class="token punctuation">)</span>
            <span class="token keyword">values</span> <span class="token punctuation">(</span>oldtuple<span class="token punctuation">.</span>sno<span class="token punctuation">,</span> oldtuple<span class="token punctuation">.</span>cno<span class="token punctuation">,</span>
                    oldtuple<span class="token punctuation">.</span>grade<span class="token punctuation">,</span> newtuple<span class="token punctuation">.</span>grade<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>语句触发器：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">trigger</span> Student_Count
    <span class="token keyword">after</span> <span class="token keyword">insert</span> <span class="token keyword">on</span> Student
    referencing
        new <span class="token keyword">table</span> <span class="token keyword">as</span> delta
    <span class="token keyword">for</span> each statement
        <span class="token keyword">insert</span> <span class="token keyword">into</span> StudentInsertCount<span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>
            <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> delta<span class="token punctuation">;</span>
</code></pre></div><h1 id="_6-关系数据理论" tabindex="-1"><a class="header-anchor" href="#_6-关系数据理论" aria-hidden="true">#</a> 6. 关系数据理论</h1><ol><li>数据库的安全性概述</li><li>依赖候选码</li><li>如何求最小依赖候选码</li><li>数据库三大范式和 BCNF 概念</li><li>公理系统</li><li>如何求最小函数依赖集</li><li>求模式分解</li></ol><h2 id="_6-1-范式" tabindex="-1"><a class="header-anchor" href="#_6-1-范式" aria-hidden="true">#</a> 6.1 范式</h2><p>为什么引入范式？因为数据库存在下面的异常</p><ol><li>数据冗余</li><li>更新异常</li><li>插入异常</li><li>删除异常</li></ol><p>设计关系数据库时，遵从不同的规范要求，这些不同的规范要求被称为不同的 <strong>范式</strong>，范式越高，冗余越小。</p><p>六种常见范式：</p><ul><li>第一范式（1NF）</li><li>第二范式（2NF）</li><li>第三范式（3NF）</li><li>巴斯 - 科德范式（BCNF）</li><li>第四范式（4NF）</li><li>第五范式（5NF），又称为 <strong>完美范式</strong></li></ul><p>一般来说，数据库只需要满足第三范式（3NF）即可。</p><h2 id="_6-2-依赖" tabindex="-1"><a class="header-anchor" href="#_6-2-依赖" aria-hidden="true">#</a> 6.2 依赖</h2><p>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 但 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>⊈</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y \nsubseteq X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0966em;vertical-align:-0.3027em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⊈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>，则称 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 是 <strong>非平凡的函数依赖</strong>。</p><p>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 但 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>⊆</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y \subseteq X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>，则称 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 是 <strong>平凡的函数依赖</strong>。</p><p>在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span> 中，如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，并且对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 的任何一个真子集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">X&#39;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，都有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>↛</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X&#39; \nrightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">↛</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，则称 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> <strong>完全函数依赖</strong>，记作</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>X</mi><mover><mo><mo>→</mo></mo><mi>F</mi></mover><mi>Y</mi></mrow><annotation encoding="application/x-tex"> X \mathop{\to}\limits^{F} Y </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1452em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1452em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">→</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span></p><p>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，但 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 不完全函数依赖于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>，则称 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> <strong>部分函数依赖</strong>，记作</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>X</mi><mover><mo><mo>→</mo></mo><mi>P</mi></mover><mi>Y</mi></mrow><annotation encoding="application/x-tex"> X \mathop{\to}\limits^{P} Y </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1452em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1452em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">→</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span></p><h2 id="_6-3-候选码和超码" tabindex="-1"><a class="header-anchor" href="#_6-3-候选码和超码" aria-hidden="true">#</a> 6.3 候选码和超码</h2><p><strong>候选码</strong>：可以推导出所有属性的最小集。</p><p>如何选出候选码？</p><ul><li>只出现在左边的一定是候选码</li><li>只出现在右边则一定不是候选码</li><li>左右都出现的不一定</li><li>左右都不出现的一定是候选码</li></ul><p>然后确定的候选码的闭包，如果能推导出全部则是候选码。否则逐个尝试求闭包。</p><p>比如</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><mtext>&lt;</mtext><mi>U</mi><mo separator="true">,</mo><mtext> </mtext><mi>F</mi><mtext>&gt;</mtext><mo separator="true">,</mo><mtext> </mtext><mi>U</mi><mo stretchy="false">(</mo><mi>A</mi><mo separator="true">,</mo><mtext> </mtext><mi>B</mi><mo separator="true">,</mo><mtext> </mtext><mi>C</mi><mo separator="true">,</mo><mtext> </mtext><mi>D</mi><mo separator="true">,</mo><mtext> </mtext><mi>E</mi><mo separator="true">,</mo><mtext> </mtext><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> R\text{&lt;} U,\, F \text{&gt;},\, U(A,\,B,\,C,\,D,\,E,\,G) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord text"><span class="mord">&lt;</span></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord text"><span class="mord">&gt;</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo>=</mo><mrow><mo fence="true">{</mo><mi>A</mi><mi>B</mi><mo>→</mo><mi>C</mi><mo separator="true">,</mo><mtext> </mtext><mi>C</mi><mi>D</mi><mo>→</mo><mi>E</mi><mo separator="true">,</mo><mtext> </mtext><mi>E</mi><mo>→</mo><mi>A</mi><mo separator="true">,</mo><mtext> </mtext><mi>A</mi><mo>→</mo><mi>G</mi><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex"> F = \left\{ AB \to C,\, CD \to E,\, E \to A,\, A \to G \right\} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">G</span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span></span></p><p>求候选码？</p><ol><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> 只在左边，一定是候选码</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> 只在右边，一定不是候选码</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> 只在左边，一定是候选码</li><li>每一个求闭包 <ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>D</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">BDA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span></span></span></span> 可以推得全部</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>D</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BDC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> 可以推得全部</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>D</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">BDE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> 可以推得全部</li></ul></li><li>最终可能是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>B</mi><mi>D</mi><mi>A</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mo stretchy="false">(</mo><mi>B</mi><mi>D</mi><mi>C</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mo stretchy="false">(</mo><mi>B</mi><mi>D</mi><mi>E</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{(BDA),\,(BDC),\,(BDE)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)}</span></span></span></span></li></ol><p><strong>超码</strong>：能表示所有属性的集合。</p><p>比如：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mi>D</mi><mi>A</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mo stretchy="false">(</mo><mi>B</mi><mi>D</mi><mi>C</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mo stretchy="false">(</mo><mi>B</mi><mi>D</mi><mi>E</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mo stretchy="false">(</mo><mi>B</mi><mi>D</mi><mi>C</mi><mi>A</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mo stretchy="false">(</mo><mi>B</mi><mi>D</mi><mi>E</mi><mi>A</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mo stretchy="false">(</mo><mi>A</mi><mi>B</mi><mi>C</mi><mi>D</mi><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> (BDA),\,(BDC),\,(BDE),\,(BDCA),\,(BDEA),\,(ABCDE) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span></span></p><p>候选码是最小的超码。</p><p>概念：</p><ul><li><strong>主码</strong>：候选码中的任意一个</li><li><strong>主属性</strong>：包含所有候选码的属性，如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi><mi>C</mi><mi>D</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">ABCDE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span></li><li><strong>非主属性</strong>：不包含在候选码中的属性，如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></li><li><strong>全码</strong>：所有的属性都是主码</li></ul><h2 id="_6-4-第一范式-1nf" tabindex="-1"><a class="header-anchor" href="#_6-4-第一范式-1nf" aria-hidden="true">#</a> 6.4 第一范式：1NF</h2><p>1NF是对属性的原子性约束，要求属性具有原子性，不可再分解。</p><p>数据库表的每一列（也称为属性）都是不可分割的原子数据项，不能是集合，数组，记录等非原子数据项。实体中的某个属性有多个值时，必须拆分为不同的属性。</p><p>在符合第一范式（1NF）表中的每个域值只能是实体的一个属性或一个属性的一部分。简而言之，第一范式就是无重复的域。</p><p>用户信息表：</p><table><thead><tr><th style="text-align:right;">编号</th><th style="text-align:center;">姓名</th><th style="text-align:center;">性别</th><th style="text-align:center;">年龄</th><th style="text-align:center;">联系电话</th><th style="text-align:center;">省份</th><th style="text-align:center;">城市</th><th style="text-align:center;">详细地址</th></tr></thead><tbody><tr><td style="text-align:right;">1</td><td style="text-align:center;">张洪新</td><td style="text-align:center;">男</td><td style="text-align:center;">26</td><td style="text-align:center;">0378-23459876</td><td style="text-align:center;">河南</td><td style="text-align:center;">开封</td><td style="text-align:center;">朝阳区新华路 23 号</td></tr><tr><td style="text-align:right;">2</td><td style="text-align:center;">李四平</td><td style="text-align:center;">女</td><td style="text-align:center;">32</td><td style="text-align:center;">0751-65432584</td><td style="text-align:center;">广州</td><td style="text-align:center;">广东</td><td style="text-align:center;">白云区天明路 148 号</td></tr></tbody></table><p>比如，某些数据库系统需要地址这个属性，那么需要合并 <strong>省份、城市、详细地址</strong> 这三个属性。如果我们仅仅将 <strong>地址</strong> 作为属性的话，那么它不满足第一范式。</p><h2 id="_6-5-第二范式-2nf" tabindex="-1"><a class="header-anchor" href="#_6-5-第二范式-2nf" aria-hidden="true">#</a> 6.5 第二范式：2NF</h2><p>在满足第一范式（1NF）的基础上，每一个非码属性（不在主键中的列）都必须完全函数依赖于候选码。</p><p>2NF 是对记录的惟一性约束，要求记录有惟一标识，即实体的惟一性，更通俗的说法就是一个表必须有主键 ID。</p><h2 id="_6-6-第三范式-3nf" tabindex="-1"><a class="header-anchor" href="#_6-6-第三范式-3nf" aria-hidden="true">#</a> 6.6 第三范式：3NF</h2><p>在满足第二范式的基础上，每个非主属性不依赖于其它非主属性，即在 2NF 基础上，消除非码属性对候选码的传递函数依赖。</p><p>3NF 是对字段冗余性的约束，即任何字段不能由其他字段派生出来，它要求字段没有冗余。</p><p>也就是说，任何非主属性都直接依赖于主属性，不能传递依赖于主属性。即表中的每一列只与主键直接相关，而不是间接相关（表中的每一列只能依赖于主键）。每一个非码属性既不部分依赖于码，也不传递依赖于码。</p><h2 id="_6-7-巴斯-科德范式-bcnf" tabindex="-1"><a class="header-anchor" href="#_6-7-巴斯-科德范式-bcnf" aria-hidden="true">#</a> 6.7 巴斯-科德范式：BCNF</h2><p>某些特殊情况下，即使关系模式符合 3NF 的要求，仍然存在着插入异常，修改异常与删除异常的问题。BCNF 由 Boyce 与 Codd 提出，通常被认为是修正的第三范式。</p><p><strong>巴斯-科德范式</strong>（BCNF，Boyce-Codd Normal Form）即在满足第三范式基础上，任何非主属性不能对主键子集依赖（即在 3NF 基础上，消除主属性对候选码的部分函数依赖和传递函数依赖）。</p><p>巴斯-科德范式既检查非主属性，又检查主属性。当只检查非主属性时，就成了第三范式。满足巴斯-科德范式的关系都必然满足第三范式。或者还可以换一种说法：若一个关系达到了第三范式，并且它只有一个候选码，或者它的每个候选码都是单属性，则该关系符号巴斯-科德范式。</p><p>一般来说，一个数据库设计符合 3NF 或 BCNF 就可以了。</p><h2 id="_6-8-第四范式-4nf" tabindex="-1"><a class="header-anchor" href="#_6-8-第四范式-4nf" aria-hidden="true">#</a> 6.8 第四范式：4NF</h2><p>多值依赖的概念：多值依赖即属性之间的一对多关系，记为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>↠</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">K \twoheadrightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6969em;vertical-align:-0.0135em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">↠</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>。</p><p>函数依赖事实上是单值依赖，所以不能表达属性值之间的一对多关系。</p><p>平凡的多值依赖：全集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><mi>K</mi><mo>+</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">U=K+A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> 可以对应于多个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>↠</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">K \twoheadrightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6969em;vertical-align:-0.0135em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">↠</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>。此时整个表就是一组一对多关系。</p><p>非平凡的多值依赖：全集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><mi>K</mi><mo>+</mo><mi>A</mi><mo>+</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">U=K+A+B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>，一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> 可以对应于多个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，也可以对应于多个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> 互相独立，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>↠</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">K \twoheadrightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6969em;vertical-align:-0.0135em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">↠</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>↠</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">K \twoheadrightarrow B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6969em;vertical-align:-0.0135em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">↠</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>。整个表有多组一对多关系，且有：“一” 部分是相同的属性集合，“多” 部分是互相独立的属性集合。</p><p>第四范式即在满足巴斯-科德范式（BCNF）的基础上，消除非平凡且非函数依赖的多值依赖（即把同一表内的多对多关系删除）。</p><h2 id="_6-9-第五范式-5nf" tabindex="-1"><a class="header-anchor" href="#_6-9-第五范式-5nf" aria-hidden="true">#</a> 6.9 第五范式：5NF</h2><p>即在满足第四范式（4NF）的基础上，消除不是由候选码所蕴含的连接依赖。如果关系模式 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 中的每一个连接依赖均由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的候选码所隐含，则称此关系模式符合第五范式。</p><p>函数依赖是多值依赖的一种特殊的情况，而多值依赖实际上是连接依赖的一种特殊情况。但连接依赖不像函数依赖和多值依赖可以由语义直接导出，而是在关系连接运算时才反映出来。存在连接依赖的关系模式仍可能遇到数据冗余及插入、修改、删除异常等问题。</p><h2 id="_6-10-公理系统" tabindex="-1"><a class="header-anchor" href="#_6-10-公理系统" aria-hidden="true">#</a> 6.10 公理系统</h2><p><strong>Armstrong 公理系统</strong>（Armstrong’s axiom）：设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> 为属性集总体，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> 上的一组函数依赖，于是有关系模式 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mtext>&lt;</mtext><mi>U</mi><mo separator="true">,</mo><mtext> </mtext><mi>F</mi><mtext>&gt;</mtext></mrow><annotation encoding="application/x-tex">R\text{&lt;}U,\,F\text{&gt;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord text"><span class="mord">&lt;</span></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord text"><span class="mord">&gt;</span></span></span></span></span>，对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mtext>&lt;</mtext><mi>U</mi><mo separator="true">,</mo><mtext> </mtext><mi>F</mi><mtext>&gt;</mtext></mrow><annotation encoding="application/x-tex">R\text{&lt;}U,\,F\text{&gt;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord text"><span class="mord">&lt;</span></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord text"><span class="mord">&gt;</span></span></span></span></span> 来说有以下的推理规则：</p><ol><li><strong>自反律</strong>：若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>⊆</mo><mi>X</mi><mo>⊆</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">Y \subseteq X \subseteq U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 所蕴含</li><li><strong>增广律</strong>：若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 所蕴含，且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>⊆</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">Z \subseteq U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mi>Z</mi><mo>→</mo><mi>Y</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">XZ \to YZ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">XZ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 所蕴含</li><li><strong>传递律</strong>：若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 及 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">Y \to Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 所蕴含，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X \to Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 所蕴含</li></ol><p>根据这三条推理规则得：</p><ol><li><strong>合并规则</strong>：由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mo separator="true">,</mo><mtext> </mtext><mi>X</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X \to Y,\,X \to Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>，有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">X \to YZ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></li><li><strong>伪传递规则</strong>：由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mo separator="true">,</mo><mtext> </mtext><mi>W</mi><mi>Y</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X \to Y,\,WY \to Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">WY</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>，有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mi>W</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">XW \to Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></li><li><strong>分解规则</strong>：由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mo separator="true">,</mo><mtext> </mtext><mi>Z</mi><mo>⊆</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y,\,Z \subseteq Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X \to Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></li></ol><h2 id="_6-11-求函数最小依赖" tabindex="-1"><a class="header-anchor" href="#_6-11-求函数最小依赖" aria-hidden="true">#</a> 6.11 求函数最小依赖</h2><p>什么是 <strong>依赖</strong>？</p><p>依赖是指关系中一个或一组属性的值可以决定其他属性的值，比如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \to B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> 就是一个依赖。</p><p>如何求最小依赖集？</p><ol><li>拆右边为多个元素的依赖关系 <ul><li>比如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">A \to BC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span></span></span></span> 拆分为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi><mo separator="true">,</mo><mtext> </mtext><mi>A</mi><mo>→</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A \to B,\,A \to C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></li></ul></li><li>去除当前元素，然后求闭包 <ul><li>如果可以推出全部则去除</li><li>重复上面的步骤直到不能操作为止</li></ul></li><li>左边最小化 <ul><li>将左边的一个去除求闭包，如果可以推出全部则去除</li><li>重复上面的步骤</li></ul></li></ol><p>例如，已知关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mtext>&lt;</mtext><mi>U</mi><mo separator="true">,</mo><mtext> </mtext><mi>F</mi><mtext>&gt;</mtext></mrow><annotation encoding="application/x-tex">R\text{&lt;}U,\,F\text{&gt;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord text"><span class="mord">&lt;</span></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord text"><span class="mord">&gt;</span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo stretchy="false">{</mo><mi>A</mi><mo separator="true">,</mo><mtext> </mtext><mi>B</mi><mo separator="true">,</mo><mtext> </mtext><mi>C</mi><mo separator="true">,</mo><mtext> </mtext><mi>D</mi><mo separator="true">,</mo><mtext> </mtext><mi>E</mi><mo separator="true">,</mo><mtext> </mtext><mi>F</mi><mo separator="true">,</mo><mtext> </mtext><mi>G</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">U\{A,\,B,\,C,\,D,\,E,\,F,\,G\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mopen">{</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">G</span><span class="mclose">}</span></span></span></span>，且</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo>=</mo><mo stretchy="false">{</mo><mi>B</mi><mi>C</mi><mi>D</mi><mo>→</mo><mi>A</mi><mo separator="true">,</mo><mtext> </mtext><mi>B</mi><mi>C</mi><mo>→</mo><mi>E</mi><mo separator="true">,</mo><mtext> </mtext><mi>A</mi><mo>→</mo><mi>F</mi><mo separator="true">,</mo><mtext> </mtext><mi>F</mi><mo>→</mo><mi>G</mi><mo separator="true">,</mo><mtext> </mtext><mi>C</mi><mo>→</mo><mi>D</mi><mo separator="true">,</mo><mtext> </mtext><mi>A</mi><mo>→</mo><mi>G</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex"> F = \{ BCD \to A,\, BC \to E,\, A \to F,\, F \to G,\, C \to D,\, A \to G \} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mclose">}</span></span></span></span></span></p><p>最终答案为</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">{</mo><mi>B</mi><mi>C</mi><mo>→</mo><mi>E</mi><mo separator="true">,</mo><mtext> </mtext><mi>B</mi><mi>C</mi><mo>→</mo><mi>A</mi><mo separator="true">,</mo><mtext> </mtext><mi>A</mi><mo>→</mo><mi>F</mi><mo separator="true">,</mo><mtext> </mtext><mi>F</mi><mo>→</mo><mi>G</mi><mo separator="true">,</mo><mtext> </mtext><mi>C</mi><mo>→</mo><mi>D</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex"> \{ BC \to E,\, BC \to A,\, A \to F,\, F \to G,\, C \to D \} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">}</span></span></span></span></span></p><h2 id="_6-12-模式分解" tabindex="-1"><a class="header-anchor" href="#_6-12-模式分解" aria-hidden="true">#</a> 6.12 模式分解</h2><p>准则：</p><ul><li>无损连接 <ul><li>无损就是分解后再次连接，和分解之前一样</li></ul></li><li>保持函数依赖 <ul><li>即函数依赖不变</li></ul></li></ul><p>已知</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>A</mi><mi>B</mi><mi>C</mi><mi>D</mi><mi>E</mi><mi>G</mi><mi>H</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mi>F</mi><mo>=</mo><mo stretchy="false">{</mo><mi>A</mi><mo>→</mo><mi>D</mi><mo separator="true">,</mo><mtext> </mtext><mi>E</mi><mo>→</mo><mi>D</mi><mo separator="true">,</mo><mtext> </mtext><mi>D</mi><mo>→</mo><mi>B</mi><mo separator="true">,</mo><mtext> </mtext><mi>B</mi><mi>C</mi><mo>→</mo><mi>D</mi><mo separator="true">,</mo><mtext> </mtext><mi>D</mi><mi>C</mi><mo>→</mo><mi>A</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex"> R(ABCDEGH),\, F = \{ A \to D,\, E \to D,\, D \to B,\, BC \to D,\, DC \to A \} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">EG</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">}</span></span></span></span></span></p><p>求保持函数依赖的 3NF 的分解。</p><p>步骤：</p><ol><li>求最小函数依赖集</li><li>把不在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 里面的属性都找出来，单独分一类，并去除</li><li>把每一个依赖左边相同的分成一类，没有一样的，就把 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">A \to D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> 改为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>A</mi><mi>D</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{AD\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">}</span></span></span></span>，如果一样 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>A</mi><mo>→</mo><mi>B</mi><mo separator="true">,</mo><mtext> </mtext><mi>A</mi><mo>→</mo><mi>C</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{A \to B,\, A \to C\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">}</span></span></span></span> 就改为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>A</mi><mi>B</mi><mi>C</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{ABC\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mclose">}</span></span></span></span></li><li>如果候选码没有出现在分离里面，把任意一个候选码作为一类</li></ol><p>过程：</p><ul><li>函数最小依赖集为<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mi>min</mi><mo>⁡</mo></msub><mo>=</mo><mo stretchy="false">{</mo><mi>A</mi><mo>→</mo><mi>D</mi><mo separator="true">,</mo><mtext> </mtext><mi>E</mi><mo>→</mo><mi>D</mi><mo separator="true">,</mo><mtext> </mtext><mi>D</mi><mo>→</mo><mi>B</mi><mo separator="true">,</mo><mtext> </mtext><mi>B</mi><mi>C</mi><mo>→</mo><mi>D</mi><mo separator="true">,</mo><mtext> </mtext><mi>D</mi><mi>C</mi><mo>→</mo><mi>A</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex"> F_{\min} = \{A \to D,\,E \to D,\,D \to B,\,BC \to D,\,DC \to A\} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">}</span></span></span></span></span></p></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">GH</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> 没有在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 里面，单独分类 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>G</mi><mi>H</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{GH\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose">}</span></span></span></span></li><li>候选码 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">CE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">CE</span></span></span></span></li><li>结果<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">{</mo><mi>A</mi><mi>D</mi><mo stretchy="false">}</mo><mo stretchy="false">{</mo><mi>E</mi><mi>D</mi><mo stretchy="false">}</mo><mo stretchy="false">{</mo><mi>D</mi><mi>B</mi><mo stretchy="false">}</mo><mo stretchy="false">{</mo><mi>B</mi><mi>C</mi><mi>D</mi><mo stretchy="false">}</mo><mo stretchy="false">{</mo><mi>D</mi><mi>C</mi><mi>A</mi><mo stretchy="false">}</mo><mo stretchy="false">{</mo><mi>C</mi><mi>E</mi><mo stretchy="false">}</mo><mo stretchy="false">{</mo><mi>G</mi><mi>H</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex"> \{AD\}\{ED\}\{DB\}\{BCD\}\{DCA\}\{CE\}\{GH\} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">}</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">}</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">}</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">}</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">A</span><span class="mclose">}</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.05764em;">CE</span><span class="mclose">}</span><span class="mopen">{</span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose">}</span></span></span></span></span></p></li></ul><h1 id="_7-数据库的设计" tabindex="-1"><a class="header-anchor" href="#_7-数据库的设计" aria-hidden="true">#</a> 7. 数据库的设计</h1><ol><li>数据库设计的基本步骤</li><li>E-R 图的构建</li><li>E-R 图转换为关系模型</li></ol><h2 id="_7-1-数据库谁的基本步骤" tabindex="-1"><a class="header-anchor" href="#_7-1-数据库谁的基本步骤" aria-hidden="true">#</a> 7.1 数据库谁的基本步骤</h2><p>步骤：</p><ol><li>需求分析</li><li>概念结构设计 <ul><li>E-R 图</li><li>设计数据字典</li></ul></li><li>逻辑结构设计 <ul><li>把 E-R 图转换为逻辑模型</li></ul></li><li>物理结构设计 <ul><li>把逻辑模型转换为物理模型</li></ul></li><li>数据库实施 <ul><li>写 SQL 代码</li></ul></li><li>数据库运行维护 <ul><li>性能检测</li></ul></li></ol><h2 id="_7-2-e-r-图" tabindex="-1"><a class="header-anchor" href="#_7-2-e-r-图" aria-hidden="true">#</a> 7.2 E-R 图</h2><p>特点：</p><ul><li>实体是矩形</li><li>属性是椭圆形</li><li>关系为菱形</li></ul><p>关系：</p><ul><li>一对一： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>:</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1:1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li><li>一对多： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>:</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1:n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></li><li>多对多： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>:</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m:n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></li></ul><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><h1 id="_8-数据库编程" tabindex="-1"><a class="header-anchor" href="#_8-数据库编程" aria-hidden="true">#</a> 8. 数据库编程</h1><ol><li>了解嵌入式 SQL</li><li>嵌入式 SQL 的处理过程</li><li>SQL 与主语言的通信</li></ol><h2 id="_8-1-嵌入式-sql" tabindex="-1"><a class="header-anchor" href="#_8-1-嵌入式-sql" aria-hidden="true">#</a> 8.1 嵌入式 SQL</h2><p>本节简单阐述概念，如果想深入了解可以阅读相关语言、框架的文档。</p><p><strong>嵌入式 SQL</strong>：把 SQL 语句嵌入到其他程序里面，如 Java / C++。</p><p>嵌入式 SQL 的处理过程：</p><ol><li>预编译转换为函数调用</li><li>主语言编译</li><li>变成主语言所编译的类型</li></ol><p>SQL 与主语言通信：</p><ol><li>SQL 给主语言传递状态</li><li>主语言给 SQL 提供参数</li><li>SQL 把查询结果交给主语言处理 <ul><li>游标</li><li>主变量实现</li></ul></li></ol><h1 id="_9-关系查询处理和优化" tabindex="-1"><a class="header-anchor" href="#_9-关系查询处理和优化" aria-hidden="true">#</a> 9. 关系查询处理和优化</h1><ol><li>查询过程</li><li>查询优化的四个阶段</li><li>代数优化</li></ol><h2 id="_9-1-查询过程" tabindex="-1"><a class="header-anchor" href="#_9-1-查询过程" aria-hidden="true">#</a> 9.1 查询过程</h2><p><img src="/vuepress-database-notes/assets/query-process-adc18d97.svg" alt="" loading="lazy"></p><p>查询优化的四个阶段：</p><ol><li>查询分析</li><li>查询检查</li><li>查询优化 <ul><li>代数优化</li><li>物理优化</li></ul></li><li>查询执行</li></ol><p>代数优化原则：</p><ul><li>选择运算尽量先做</li><li>把投影运算和选择运算同时执行</li><li>把投影同它前后的双目运算符连接起来</li></ul><p>查询树：</p><ul><li><code>project(Sname)</code></li><li><code>select(SC.Cno=&#39;2&#39;)</code></li><li><code>join(Student.Sno=SC.Sno)</code><ul><li><code>Student</code></li><li><code>SC</code></li></ul></li></ul><p>关系代数语法图：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mtext>Sname</mtext></msub></mrow><annotation encoding="application/x-tex">\Pi_{\text{Sname}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Sname</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mtext>SC.Cno=‘2’</mtext></msub></mrow><annotation encoding="application/x-tex">\sigma_{\text{SC.Cno=‘2’}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">SC.Cno=‘2’</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mtext>Student.Sno=SC.Sno</mtext></msub></mrow><annotation encoding="application/x-tex">\sigma_{\text{Student.Sno=SC.Sno}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Student.Sno=SC.Sno</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Student</mtext></mrow><annotation encoding="application/x-tex">\text{Student}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">Student</span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>SC</mtext></mrow><annotation encoding="application/x-tex">\text{SC}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">SC</span></span></span></span></span></li></ul></li></ul><p>优化后的查询树：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mtext>Sname</mtext></msub></mrow><annotation encoding="application/x-tex">\Pi_{\text{Sname}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Sname</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋈</mo></mrow><annotation encoding="application/x-tex">\Join</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.51em;vertical-align:-0.005em;"></span><span class="mrel">⋈</span></span></span></span> ： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Student.Sno=SC.Sno</mtext></mrow><annotation encoding="application/x-tex">\text{Student.Sno=SC.Sno}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">Student.Sno=SC.Sno</span></span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Student</mtext></mrow><annotation encoding="application/x-tex">\text{Student}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">Student</span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mtext>SC.Cno=‘2’</mtext></msub></mrow><annotation encoding="application/x-tex">\sigma_{\text{SC.Cno=‘2’}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">SC.Cno=‘2’</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>SC</mtext></mrow><annotation encoding="application/x-tex">\text{SC}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">SC</span></span></span></span></span></li></ul></li></ul></li></ul><h1 id="_10-数据恢复技术" tabindex="-1"><a class="header-anchor" href="#_10-数据恢复技术" aria-hidden="true">#</a> 10. 数据恢复技术</h1><ol><li>事务特性</li><li>故障及恢复</li></ol><h2 id="_10-1-事务" tabindex="-1"><a class="header-anchor" href="#_10-1-事务" aria-hidden="true">#</a> 10.1 事务</h2><p>事务的四大特性（ACID）：</p><ol><li>A：<strong>原子性</strong>（autom）：要么全做、要么全不做</li><li>C：<strong>一致性</strong>（consistent）：与原子性相关，数据必须是一致的，比如银行汇款</li><li>I：<strong>隔离性</strong>（isolate）：一个事务的执行不能被其他事务打扰</li><li>D：<strong>持久性</strong>（duration）：数据库的改变是永久的，比如写入磁盘</li></ol><h2 id="_10-2-故障" tabindex="-1"><a class="header-anchor" href="#_10-2-故障" aria-hidden="true">#</a> 10.2 故障</h2><p>故障的种类：</p><ul><li>事务内部故障 <ul><li>采取 REDO 和 UNDO 技术（重做和撤销）</li></ul></li><li>系统故障 <ul><li>DBMS 所运行的机器停转或宕机，需要重启</li></ul></li><li>介质故障 <ul><li>硬件设备损坏</li></ul></li><li>计算机病毒</li></ul><p>恢复方式：</p><ul><li>数据转储 <ul><li>对失败的事务重新执行</li></ul></li><li>日志文件 <ul><li>记录事务对数据的更新操作</li></ul></li></ul><p>恢复策略：</p><ul><li>事务故障 <ul><li>事务异常终止，撤销之前的操作，回滚操作</li></ul></li><li>系统故障 <ul><li>没有执行完的事务 UNDO</li><li>丢失的事务 REDO</li></ul></li><li>介质故障 <ul><li>重装数据库</li><li>重做事务</li></ul></li></ul><p><img src="/vuepress-database-notes/assets/error-recovery-efd0a102.svg" alt="" loading="lazy"></p><h1 id="_11-并发控制" tabindex="-1"><a class="header-anchor" href="#_11-并发控制" aria-hidden="true">#</a> 11. 并发控制</h1><ol><li>什么是并发</li><li>并发带来的问题</li><li>三级锁协议</li><li>可串行性</li></ol><h2 id="_11-1-概念" tabindex="-1"><a class="header-anchor" href="#_11-1-概念" aria-hidden="true">#</a> 11.1 概念</h2><p>数据库的 <strong>并发</strong>：多个数据同时写入。</p><p>并发带来的问题：</p><ol><li>丢失修改 <ul><li>修改没有生效</li></ul></li><li>读脏数据 <ul><li>读取时恰好别的用户在修改它，读取了正在被修改的数据</li></ul></li><li>不可重复读 <ul><li>连续两次读取的数据不同</li></ul></li></ol><p>丢失修改：</p><table><thead><tr><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">\rm R(A)=16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">16</span></span></span></span></span></td><td></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">\rm R(A)=16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">16</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">A</mi><mo>=</mo><mi mathvariant="normal">A</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\rm A=A-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathrm">1</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">W</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo><mo>=</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">\rm W(A)=15</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">W</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">15</span></span></span></span></span></td><td></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">A</mi><mo>=</mo><mi mathvariant="normal">A</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\rm A=A-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathrm">1</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">W</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo><mo>=</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">\rm W(A)=15</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">W</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">15</span></span></span></span></span></td></tr></tbody></table><p>读脏数据：</p><table><thead><tr><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">C</mi><mo stretchy="false">)</mo><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">\rm R(C)=100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">100</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">C</mi><mo>=</mo><mi mathvariant="normal">C</mi><mo>∗</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\rm C=C*2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathrm">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathrm">2</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">W</mi><mo stretchy="false">(</mo><mi mathvariant="normal">C</mi><mo stretchy="false">)</mo><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">\rm W(C)=200</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">W</span><span class="mopen">(</span><span class="mord mathrm">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">200</span></span></span></span></span></td><td></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">C</mi><mo stretchy="false">)</mo><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">\rm R(C)=200</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">200</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mi mathvariant="normal">O</mi><mi mathvariant="normal">L</mi><mi mathvariant="normal">L</mi><mi mathvariant="normal">B</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">C</mi><mi mathvariant="normal">K</mi></mrow><annotation encoding="application/x-tex">\rm ROLLBACK</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathrm">ROLLBACK</span></span></span></span></span></td><td></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">W</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo><mo>=</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">\rm W(A)=15</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">W</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">15</span></span></span></span></span></td></tr></tbody></table><p>不可重复读：</p><table><thead><tr><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">\rm R(A)=16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">16</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">\rm R(B)=100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">100</span></span></span></span></span></td><td></td></tr><tr><td>此时 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>+</mo><mi>B</mi><mo>=</mo><mn>150</mn></mrow><annotation encoding="application/x-tex">A+B=150</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">150</span></span></span></span></td><td></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">\rm R(B)=100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">100</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">B</mi><mo>=</mo><mi mathvariant="normal">B</mi><mo>∗</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\rm B=B*2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathrm">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathrm">2</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">W</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">\rm W(B)=200</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">W</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">200</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">\rm R(A)=50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">50</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">\rm R(B)=200</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">200</span></span></span></span></span></td><td></td></tr><tr><td>此时 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> 恢复为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">100</span></span></span></span></td><td></td></tr></tbody></table><h2 id="_11-2-锁" tabindex="-1"><a class="header-anchor" href="#_11-2-锁" aria-hidden="true">#</a> 11.2 锁</h2><p>有两种锁：</p><ol><li>排它锁，也叫写锁 X 锁</li><li>共享锁，也叫读锁 S 锁</li></ol><p>封锁协议：</p><ol><li>一级封锁协议 <ul><li>修改时，必须加上 X 锁，直到结束</li><li>解决 <strong>丢失修改</strong> 问题</li></ul></li><li>二级封锁协议 <ul><li>读的时候，加上 S 锁，用完就释放</li><li>解决 <strong>读脏数据</strong> 问题</li></ul></li><li>三级封锁协议 <ul><li>读的时候加上 S 锁，直到结束</li><li>解决 <strong>不可重复读</strong> 问题</li></ul></li></ol><table><thead><tr><th></th><th style="text-align:right;">X</th><th style="text-align:left;">锁</th><th style="text-align:right;">S</th><th style="text-align:left;">锁</th><th style="text-align:right;">一</th><th style="text-align:center;">致</th><th style="text-align:left;">性</th></tr></thead><tbody><tr><td>特点</td><td style="text-align:right;">事务结束释放</td><td style="text-align:left;">操作结束释放</td><td style="text-align:right;">事务结束释放</td><td style="text-align:left;">操作结束释放</td><td style="text-align:right;">不丢失修改</td><td style="text-align:center;">不读脏数据</td><td style="text-align:left;">可重复读</td></tr><tr><td>一级</td><td style="text-align:right;">🟢</td><td style="text-align:left;"></td><td style="text-align:right;"></td><td style="text-align:left;"></td><td style="text-align:right;">🟢</td><td style="text-align:center;"></td><td style="text-align:left;"></td></tr><tr><td>二级</td><td style="text-align:right;">🟢</td><td style="text-align:left;"></td><td style="text-align:right;"></td><td style="text-align:left;">🟢</td><td style="text-align:right;">🟢</td><td style="text-align:center;">🟢</td><td style="text-align:left;"></td></tr><tr><td>三级</td><td style="text-align:right;">🟢</td><td style="text-align:left;"></td><td style="text-align:right;">🟢</td><td style="text-align:left;"></td><td style="text-align:right;">🟢</td><td style="text-align:center;">🟢</td><td style="text-align:left;">🟢</td></tr></tbody></table><h2 id="_11-3-可串行性" tabindex="-1"><a class="header-anchor" href="#_11-3-可串行性" aria-hidden="true">#</a> 11.3 可串行性</h2><p><strong>可串行性</strong> 意味着多种情况都可以，并发后结果是任意一个就可以。</p><p>例如：</p><ul><li>事务 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo>:</mo><mi>A</mi><mo>=</mo><mi>B</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">T_1: A = B + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li><li>事务 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub><mo>:</mo><mi>B</mi><mo>=</mo><mi>A</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">T_2: B = A + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li><li>先 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 后 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mn>4</mn><mo separator="true">,</mo><mtext> </mtext><mi>B</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">A = 4,\,B = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span></li><li>先 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 后 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mn>3</mn><mo separator="true">,</mo><mtext> </mtext><mi>B</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">A = 3,\,B = 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></li></ul><p>如果这两种结果都是可接受的，那么它就是可串行的。</p><h1 id="附录-a-实验-sql" tabindex="-1"><a class="header-anchor" href="#附录-a-实验-sql" aria-hidden="true">#</a> 附录 A：实验 SQL</h1><h2 id="实验一" tabindex="-1"><a class="header-anchor" href="#实验一" aria-hidden="true">#</a> 实验一</h2><p>创建一个名为 <code>StuDB</code> 的数据库，在该数据库下根据下列表格给出的内容创建四个表 <code>S</code>（学生）、<code>C</code>（课程表）、<code>SC</code>（选课关系表）、<code>Dept</code>（系部表）。</p><p><code>S</code> 表：</p><table><thead><tr><th style="text-align:center;">字段名称</th><th style="text-align:center;">数据类型</th><th style="text-align:center;">主码</th><th style="text-align:center;">可空</th><th style="text-align:center;">默认值</th></tr></thead><tbody><tr><td style="text-align:center;"><code>Sno</code></td><td style="text-align:center;">长整型</td><td style="text-align:center;">*</td><td style="text-align:center;"><code>NOT NULL</code></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"><code>Sname</code></td><td style="text-align:center;">文本</td><td style="text-align:center;"></td><td style="text-align:center;"><code>NULL</code></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"><code>Sex</code></td><td style="text-align:center;">文本</td><td style="text-align:center;"></td><td style="text-align:center;"><code>NULL</code></td><td style="text-align:center;"><code>&#39;男&#39;</code></td></tr><tr><td style="text-align:center;"><code>Age</code></td><td style="text-align:center;">长整型</td><td style="text-align:center;"></td><td style="text-align:center;"><code>NULL</code></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"><code>Deptno</code></td><td style="text-align:center;">长整型</td><td style="text-align:center;"></td><td style="text-align:center;"><code>NOT NULL</code></td><td style="text-align:center;"></td></tr></tbody></table><p><code>C</code> 表：</p><table><thead><tr><th style="text-align:center;">字段名称</th><th style="text-align:center;">数据类型</th><th style="text-align:center;">主码</th><th style="text-align:center;">可空</th><th style="text-align:center;">默认值</th></tr></thead><tbody><tr><td style="text-align:center;"><code>Cno</code></td><td style="text-align:center;">长整型</td><td style="text-align:center;">*</td><td style="text-align:center;"><code>NOT NULL</code></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"><code>Cname</code></td><td style="text-align:center;">文本</td><td style="text-align:center;"></td><td style="text-align:center;"><code>NULL</code></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"><code>Cpno</code></td><td style="text-align:center;">长整型</td><td style="text-align:center;"></td><td style="text-align:center;"><code>NULL</code></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"><code>Credit</code></td><td style="text-align:center;">单精度</td><td style="text-align:center;"></td><td style="text-align:center;"><code>NULL</code></td><td style="text-align:center;"></td></tr></tbody></table><p><code>SC</code> 表：</p><table><thead><tr><th style="text-align:center;">字段名称</th><th style="text-align:center;">数据类型</th><th style="text-align:center;">主码</th><th style="text-align:center;">可空</th><th style="text-align:center;">默认值</th></tr></thead><tbody><tr><td style="text-align:center;"><code>Sno</code></td><td style="text-align:center;">长整型</td><td style="text-align:center;">*</td><td style="text-align:center;"><code>NOT NULL</code></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"><code>Cno</code></td><td style="text-align:center;">长整型</td><td style="text-align:center;">*</td><td style="text-align:center;"><code>NOT NULL</code></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"><code>Grade</code></td><td style="text-align:center;">单精度</td><td style="text-align:center;"></td><td style="text-align:center;"><code>NULL</code></td><td style="text-align:center;"></td></tr></tbody></table><p><code>Dept</code> 表：</p><table><thead><tr><th style="text-align:center;">字段名称</th><th style="text-align:center;">数据类型</th><th style="text-align:center;">主码</th><th style="text-align:center;">可空</th><th style="text-align:center;">默认值</th></tr></thead><tbody><tr><td style="text-align:center;"><code>Deptno</code></td><td style="text-align:center;">长整型</td><td style="text-align:center;">*</td><td style="text-align:center;"><code>NOT NULL</code></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"><code>Deptname</code></td><td style="text-align:center;">文本</td><td style="text-align:center;"></td><td style="text-align:center;"><code>NULL</code></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"><code>Mastername</code></td><td style="text-align:center;">文本</td><td style="text-align:center;"></td><td style="text-align:center;"><code>NULL</code></td><td style="text-align:center;"></td></tr></tbody></table><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 按照顺序创建下面四个表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Dept <span class="token punctuation">(</span>
    Deptno <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    Deptname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Mastername <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Deptno<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> S <span class="token punctuation">(</span>
    Sno <span class="token keyword">BIGINT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    Sname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Sex <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span>
    Age <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
    Deptno <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Deptno<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> Dept<span class="token punctuation">(</span>Deptno<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> C <span class="token punctuation">(</span>
    Cno <span class="token keyword">BIGINT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    Cname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Cpno <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
    Credit <span class="token keyword">FLOAT</span><span class="token punctuation">,</span>
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Cpno<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> C<span class="token punctuation">(</span>Cno<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> SC <span class="token punctuation">(</span>
    Sno <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    Cno <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    Grade <span class="token keyword">FLOAT</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Sno<span class="token punctuation">,</span> Cno<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Sno<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> S<span class="token punctuation">(</span>Sno<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Cno<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> C<span class="token punctuation">(</span>Cno<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>数据内容（<code>S</code> 表）：</p><table><thead><tr><th><code>Sno</code></th><th><code>Sname</code></th><th><code>Sex</code></th><th><code>Age</code></th><th><code>Deptno</code></th></tr></thead><tbody><tr><td>991401</td><td>何丽</td><td>女</td><td>18</td><td>6</td></tr><tr><td>992401</td><td>胡涛</td><td>男</td><td>20</td><td>5</td></tr><tr><td>993401</td><td>马华</td><td>女</td><td>21</td><td>4</td></tr><tr><td>993402</td><td>马吉</td><td>男</td><td>22</td><td>4</td></tr><tr><td>994423</td><td>何小波</td><td>男</td><td>22</td><td>3</td></tr><tr><td>994424</td><td>路敏</td><td>女</td><td>20</td><td>3</td></tr><tr><td>995401</td><td>朱华</td><td>女</td><td>19</td><td>2</td></tr><tr><td>995402</td><td>张立</td><td>女</td><td>18</td><td>2</td></tr><tr><td>996401</td><td>李明</td><td>男</td><td>19</td><td>1</td></tr><tr><td>996402</td><td>刘晨</td><td>男</td><td>22</td><td>1</td></tr><tr><td>996403</td><td>张征</td><td>男</td><td>21</td><td>1</td></tr></tbody></table><p>数据内容（<code>SC</code> 表）：</p><table><thead><tr><th><code>Sno</code></th><th><code>Cno</code></th><th><code>Grade</code></th></tr></thead><tbody><tr><td>991401</td><td>7</td><td>60</td></tr><tr><td>992401</td><td>3</td><td>85</td></tr><tr><td>992401</td><td>7</td><td>88</td></tr><tr><td>993401</td><td>7</td><td>85</td></tr><tr><td>993402</td><td>7</td><td>90</td></tr><tr><td>994423</td><td>6</td><td></td></tr><tr><td>994423</td><td>7</td><td>75</td></tr><tr><td>994424</td><td>6</td><td>70</td></tr><tr><td>994424</td><td>7</td><td>60</td></tr><tr><td>995401</td><td>1</td><td>70</td></tr><tr><td>995401</td><td>7</td><td>80</td></tr><tr><td>995402</td><td>7</td><td></td></tr><tr><td>996401</td><td>1</td><td>80</td></tr><tr><td>996401</td><td>2</td><td>95</td></tr><tr><td>996401</td><td>7</td><td>85</td></tr><tr><td>996402</td><td>1</td><td>75</td></tr><tr><td>996402</td><td>2</td><td>60</td></tr><tr><td>996402</td><td>7</td><td>80</td></tr><tr><td>996403</td><td>1</td><td>70</td></tr><tr><td>996403</td><td>7</td><td>80</td></tr></tbody></table><p>数据内容（<code>C</code> 表）：</p><table><thead><tr><th><code>Cno</code></th><th><code>Cname</code></th><th><code>Cpno</code></th><th><code>Credit</code></th></tr></thead><tbody><tr><td>1</td><td>数据库原理</td><td>4</td><td>4</td></tr><tr><td>2</td><td>计算数学</td><td></td><td>3</td></tr><tr><td>3</td><td>管理信息系统</td><td>1</td><td>3</td></tr><tr><td>4</td><td>数据结构</td><td>6</td><td>4</td></tr><tr><td>5</td><td>操作系统</td><td>7</td><td>4</td></tr><tr><td>6</td><td>C语言</td><td>7</td><td>5</td></tr><tr><td>7</td><td>计算机基础</td><td></td><td>3</td></tr></tbody></table><p>数据内容（<code>Dept</code> 表）：</p><table><thead><tr><th><code>Deptno</code></th><th><code>Deptname</code></th><th><code>Mastername</code></th></tr></thead><tbody><tr><td>1</td><td>计算机系</td><td>刘红</td></tr><tr><td>2</td><td>信息系</td><td>李兰</td></tr><tr><td>3</td><td>数学系</td><td>张华</td></tr><tr><td>4</td><td>质量系</td><td>李兰</td></tr><tr><td>5</td><td>经管系</td><td>李辉</td></tr><tr><td>6</td><td>电气系</td><td>刘卫国</td></tr><tr><td>7</td><td>语文系</td><td>许卫国</td></tr></tbody></table><h2 id="实验二" tabindex="-1"><a class="header-anchor" href="#实验二" aria-hidden="true">#</a> 实验二</h2><ol><li>用 SQL 语句创建一个新表 <code>S1</code>（表的结构与学生表 <code>S</code> 一致），要包含主键、外键（参照 <code>Dept</code> 表）和默认值的定义</li><li>使用 SQL 语句删除表 <code>S1</code></li><li>将一个新学生记录 <code>(997401, &#39;张小玉&#39;, &#39;女&#39;, 20, 7)</code> 插入到学生表 <code>S</code> 中</li><li>往成绩表中增加一条记录 <code>(991401, 8, 100)</code>，发现什么问题，如何解决？</li><li>插入一条无成绩的选课记录 <code>(997401, 7)</code></li><li>将学生 <code>997401</code> 的年龄改为 <code>22</code> 岁</li><li>将所有男学生的年龄增加一岁</li><li>删除学号为 <code>997401</code> 的学生记录</li><li>删除课程编号为 <code>7</code> 的课程记录</li><li>查询每门课程先修课的课程名（查询结果包括课程号，先修课课程号，先修课课程名）</li><li>查询年龄在 <code>19</code> 岁（含 <code>19</code> 岁）以上的学生记录</li><li>查询考试成绩为 <code>80</code>（含 <code>80</code> 分）分以上的成绩信息</li><li>查询全体女生的详细信息</li><li>查询 <code>1</code> 号系学生的选课信息</li><li>删除系部编号为 <code>1</code> 的系部信息，发现什么问题，如何解决？</li></ol><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 创建表 S1</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> S1 <span class="token punctuation">(</span>
    Sno <span class="token keyword">BIGINT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    Sname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Sex <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span>
    Age <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
    Deptno <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Deptno<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> Dept<span class="token punctuation">(</span>Deptno<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除表 S1</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> S1<span class="token punctuation">;</span>

<span class="token comment">-- 插入数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> S <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">997401</span><span class="token punctuation">,</span> <span class="token string">&#39;张小玉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 8 不在 SC 中</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">991401</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 解决方法：将 8 替换为 6</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">991401</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 或者插入一条到 C 表</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> C <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&#39;新课程&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 无成绩的记录</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token punctuation">(</span>Sno<span class="token punctuation">,</span> Cno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">997401</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 更新</span>
<span class="token keyword">UPDATE</span> S <span class="token keyword">SET</span> Age <span class="token operator">=</span> <span class="token number">22</span> <span class="token keyword">WHERE</span> Sno <span class="token operator">=</span> <span class="token number">997401</span><span class="token punctuation">;</span>

<span class="token comment">-- 更新全部年龄</span>
<span class="token keyword">UPDATE</span> S <span class="token keyword">SET</span> Age <span class="token operator">=</span> Age <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除学生记录</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> Sno <span class="token operator">=</span> <span class="token number">997401</span><span class="token punctuation">;</span>
<span class="token comment">-- 去除约束</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> Sno <span class="token operator">=</span> <span class="token number">997401</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除课程号</span>
<span class="token keyword">UPDATE</span> C <span class="token keyword">SET</span> Cpno <span class="token operator">=</span> <span class="token boolean">NULL</span> <span class="token keyword">WHERE</span> Cpno <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> Cno <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
<span class="token comment">-- 去除约束</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> C <span class="token keyword">WHERE</span> Cno <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询先修课程</span>
<span class="token keyword">SELECT</span> C<span class="token punctuation">.</span>Cno<span class="token punctuation">,</span> C<span class="token punctuation">.</span>Cpno<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> Cname <span class="token keyword">FROM</span> C <span class="token keyword">as</span> _C <span class="token keyword">WHERE</span> _C<span class="token punctuation">.</span>Cno <span class="token operator">=</span> C<span class="token punctuation">.</span>Cpno<span class="token punctuation">)</span> <span class="token keyword">as</span> CPName <span class="token keyword">FROM</span> C<span class="token punctuation">;</span>

<span class="token comment">-- 年龄查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> Age <span class="token operator">&gt;=</span> <span class="token number">19</span><span class="token punctuation">;</span>

<span class="token comment">-- 成绩查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> Grade <span class="token operator">&gt;=</span> <span class="token number">80</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询女生</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> Sex <span class="token operator">=</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- 1 号系学生选课信息</span>
<span class="token keyword">SELECT</span> S<span class="token punctuation">.</span>Sno<span class="token punctuation">,</span> SC<span class="token punctuation">.</span>Cno <span class="token keyword">FROM</span> S<span class="token punctuation">,</span> SC
    <span class="token keyword">WHERE</span> S<span class="token punctuation">.</span>Sno <span class="token operator">=</span> SC<span class="token punctuation">.</span>Sno <span class="token operator">and</span> S<span class="token punctuation">.</span>Deptno <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">-- 或者</span>
<span class="token keyword">SELECT</span> S<span class="token punctuation">.</span>Sno<span class="token punctuation">,</span> SC<span class="token punctuation">.</span>Cno <span class="token keyword">FROM</span> S
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> SC <span class="token keyword">ON</span> S<span class="token punctuation">.</span>Sno <span class="token operator">=</span> SC<span class="token punctuation">.</span>Sno
    <span class="token keyword">WHERE</span> S<span class="token punctuation">.</span>Deptno <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 与 S 约束冲突</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> Dept <span class="token keyword">WHERE</span> Deptno <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">-- 解决办法：删除冲突的记录</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> Sno <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> Sno <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> Deptno <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> Deptno <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实验三" tabindex="-1"><a class="header-anchor" href="#实验三" aria-hidden="true">#</a> 实验三</h2><ol><li>查询 “计算机系” 学生的学号与姓名</li><li>查询年龄大于 <code>20</code> 岁的所有学生的信息</li><li>查询成绩小于 <code>80</code> 分的学生学号、姓名、课程名、成绩，并按学号升序、成绩将序排列</li><li>查询所有没有成绩的学生的学号</li><li>查询选修各门课程的学生的人数、平均成绩、最高分、最低分和总分</li><li>查询至少选修了两门以上课程的学生学号</li><li>查询所有姓 “张” 的学生的详细情况</li><li>查询每一门课程的先修课的先修课</li><li>查询选修 “数据库原理” 且成绩在 <code>70</code> 分以上的学生学号、姓名（分别用多表连接和嵌套查询完成）</li><li>查询计算机系没有选修 <code>7</code> 号课程的学生的学号和姓名</li><li>查询被所有学生都选修的课程名称</li><li>查询至少选修了学生 “张征” 选修的全部课程的学生的学号和姓名</li><li>查询学分大于 <code>4</code> 或等于 <code>3</code> 的课程的名称和学分（用 <code>union</code> 操作）</li><li>查询 “计算机系” 中比 “质量系” 所有学生年龄都小的学生姓名和年龄</li><li>查询 “计算机系” 选修 “数据库原理” 课程的学生姓名和成绩</li></ol><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 1</span>
<span class="token keyword">SELECT</span> Sno<span class="token punctuation">,</span> Sname <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> Deptno <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> Deptno <span class="token keyword">FROM</span> Dept <span class="token keyword">WHERE</span> Deptname <span class="token operator">=</span> <span class="token string">&#39;计算机系&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 2</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> Age <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">;</span>

<span class="token comment">-- 3</span>
<span class="token keyword">SELECT</span> S<span class="token punctuation">.</span>Sno<span class="token punctuation">,</span> S<span class="token punctuation">.</span>Sname<span class="token punctuation">,</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> C<span class="token punctuation">.</span>Cname <span class="token keyword">FROM</span> C <span class="token keyword">WHERE</span> C<span class="token punctuation">.</span>Cno <span class="token operator">=</span> SC<span class="token punctuation">.</span>Cno<span class="token punctuation">)</span>
    <span class="token keyword">AS</span> Cname<span class="token punctuation">,</span> SC<span class="token punctuation">.</span>Grade
<span class="token keyword">FROM</span> S<span class="token punctuation">,</span> SC
    <span class="token keyword">WHERE</span> SC<span class="token punctuation">.</span>Grade <span class="token operator">&lt;</span> <span class="token number">80</span> <span class="token operator">AND</span> S<span class="token punctuation">.</span>Sno <span class="token operator">=</span> SC<span class="token punctuation">.</span>Sno
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> S<span class="token punctuation">.</span>Sno <span class="token keyword">ASC</span><span class="token punctuation">,</span> SC<span class="token punctuation">.</span>Grade <span class="token keyword">DESC</span><span class="token punctuation">;</span>

<span class="token comment">-- 4</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> Sno <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> Grade <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment">-- 5</span>
<span class="token keyword">SELECT</span> Cno<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>Cno<span class="token punctuation">)</span> <span class="token keyword">AS</span> NUMs<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>Grade<span class="token punctuation">)</span> <span class="token keyword">AS</span> AVGs<span class="token punctuation">,</span>
    <span class="token function">MAX</span><span class="token punctuation">(</span>Grade<span class="token punctuation">)</span> <span class="token keyword">AS</span> MAXs<span class="token punctuation">,</span> <span class="token function">MIN</span><span class="token punctuation">(</span>Grade<span class="token punctuation">)</span> <span class="token keyword">AS</span> MINs
<span class="token keyword">FROM</span> SC
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Cno<span class="token punctuation">;</span>

<span class="token comment">-- 6</span>
<span class="token keyword">SELECT</span> Sno<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>Sno<span class="token punctuation">)</span> <span class="token keyword">AS</span> NUMs <span class="token keyword">FROM</span> SC
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Sno <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>Sno<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">-- 7</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> Sname <span class="token operator">LIKE</span> <span class="token string">&#39;张%&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- 8</span>
<span class="token keyword">SELECT</span> Cno<span class="token punctuation">,</span> Cpno<span class="token punctuation">,</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> _C<span class="token punctuation">.</span>Cpno <span class="token keyword">FROM</span> C <span class="token keyword">AS</span> _C <span class="token keyword">WHERE</span> _C<span class="token punctuation">.</span>Cno <span class="token operator">=</span> C<span class="token punctuation">.</span>Cpno<span class="token punctuation">)</span> <span class="token keyword">AS</span> Ppno <span class="token keyword">FROM</span> C<span class="token punctuation">;</span>

<span class="token comment">-- 9 嵌套查询</span>
<span class="token keyword">SELECT</span> Sno<span class="token punctuation">,</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> Sname <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> Sno <span class="token operator">=</span> SC<span class="token punctuation">.</span>Sno<span class="token punctuation">)</span> <span class="token keyword">AS</span> Sname
<span class="token keyword">FROM</span> SC
    <span class="token keyword">WHERE</span> Grade <span class="token operator">&gt;</span> <span class="token number">70</span> <span class="token operator">AND</span> Cno <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> Cno <span class="token keyword">FROM</span> C <span class="token keyword">WHERE</span> Cname <span class="token operator">=</span> <span class="token string">&#39;数据库原理&#39;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 9 多表连接</span>
<span class="token keyword">SELECT</span> S<span class="token punctuation">.</span>Sno<span class="token punctuation">,</span> S<span class="token punctuation">.</span>Sname <span class="token keyword">FROM</span> S<span class="token punctuation">,</span> SC
    <span class="token keyword">WHERE</span> S<span class="token punctuation">.</span>Sno <span class="token operator">=</span> SC<span class="token punctuation">.</span>Sno <span class="token operator">AND</span>
        SC<span class="token punctuation">.</span>Grade <span class="token operator">&gt;</span> <span class="token number">70</span> <span class="token operator">AND</span>
        SC<span class="token punctuation">.</span>Cno <span class="token operator">=</span> <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> Cno <span class="token keyword">FROM</span> C <span class="token keyword">WHERE</span> Cname <span class="token operator">=</span> <span class="token string">&#39;数据库原理&#39;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 10</span>
<span class="token keyword">SELECT</span> Sno<span class="token punctuation">,</span> Sname <span class="token keyword">FROM</span> S
    <span class="token keyword">WHERE</span> Deptno <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> Deptno <span class="token keyword">FROM</span> Dept <span class="token keyword">WHERE</span> Deptname <span class="token operator">=</span> <span class="token string">&#39;计算机系&#39;</span><span class="token punctuation">)</span> <span class="token operator">AND</span> Sno <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> Sno <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> Cno <span class="token operator">=</span> <span class="token number">7</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 11</span>
<span class="token keyword">SELECT</span> C<span class="token punctuation">.</span>Cno<span class="token punctuation">,</span> C<span class="token punctuation">.</span>Cname <span class="token keyword">FROM</span> C <span class="token keyword">WHERE</span> C<span class="token punctuation">.</span>Cno <span class="token operator">IN</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> SC<span class="token punctuation">.</span>Cno <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SC<span class="token punctuation">.</span>Cno
    <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> S
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 12</span>
<span class="token comment">-- 解释为不存在一个课程 B，使得 “张征” 选择了而同学 A 没有选择</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> Sno <span class="token keyword">FROM</span> SC <span class="token keyword">AS</span> A_SC
<span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC <span class="token keyword">AS</span> B_SC <span class="token keyword">WHERE</span> B_SC<span class="token punctuation">.</span>Sno <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> S<span class="token punctuation">.</span>Sno <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> S<span class="token punctuation">.</span>Sname <span class="token operator">=</span> <span class="token string">&#39;张征&#39;</span>
    <span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC <span class="token keyword">AS</span> C_SC
        <span class="token keyword">WHERE</span> C_SC<span class="token punctuation">.</span>Cno <span class="token operator">=</span> B_SC<span class="token punctuation">.</span>Cno <span class="token operator">AND</span> C_SC<span class="token punctuation">.</span>Sno <span class="token operator">=</span> A_SC<span class="token punctuation">.</span>Sno
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 13</span>
<span class="token keyword">SELECT</span> Cname<span class="token punctuation">,</span> Credit <span class="token keyword">FROM</span> C <span class="token keyword">WHERE</span> Credit <span class="token operator">=</span> <span class="token number">3</span> <span class="token keyword">UNION</span>
    <span class="token keyword">SELECT</span> Cname<span class="token punctuation">,</span> Credit <span class="token keyword">FROM</span> C <span class="token keyword">WHERE</span> Credit <span class="token operator">&gt;</span> <span class="token number">4</span><span class="token punctuation">;</span>

<span class="token comment">-- 14</span>
<span class="token keyword">SELECT</span> Sname<span class="token punctuation">,</span> Age <span class="token keyword">FROM</span> S
<span class="token keyword">WHERE</span> S<span class="token punctuation">.</span>Deptno <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> Deptno <span class="token keyword">FROM</span> Dept
    <span class="token keyword">WHERE</span> Deptname <span class="token operator">=</span> <span class="token string">&#39;计算机系&#39;</span>
<span class="token punctuation">)</span> <span class="token operator">AND</span> S<span class="token punctuation">.</span>Age <span class="token operator">&lt;</span> <span class="token keyword">ALL</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> Age <span class="token keyword">FROM</span> S
    <span class="token keyword">WHERE</span> Deptno <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> Deptno <span class="token keyword">FROM</span> Dept
        <span class="token keyword">WHERE</span> Deptname <span class="token operator">=</span> <span class="token string">&#39;质量系&#39;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 15</span>
<span class="token keyword">SELECT</span> Sname<span class="token punctuation">,</span> Grade <span class="token keyword">FROM</span> S<span class="token punctuation">,</span> SC
<span class="token keyword">WHERE</span> S<span class="token punctuation">.</span>Sno <span class="token operator">=</span> SC<span class="token punctuation">.</span>Sno <span class="token operator">AND</span> S<span class="token punctuation">.</span>Deptno <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> Deptno <span class="token keyword">FROM</span> Dept
    <span class="token keyword">WHERE</span> Deptname <span class="token operator">=</span> <span class="token string">&#39;计算机系&#39;</span>
<span class="token punctuation">)</span> <span class="token operator">AND</span> SC<span class="token punctuation">.</span>Cno <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> Cno <span class="token keyword">FROM</span> C
    <span class="token keyword">WHERE</span> Cname <span class="token operator">=</span> <span class="token string">&#39;数据库原理&#39;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实验四" tabindex="-1"><a class="header-anchor" href="#实验四" aria-hidden="true">#</a> 实验四</h2><ol><li>以 <code>SA</code> 身份登陆系统，创建数据库用户 <code>User1</code>，使用 <code>User1</code> 用户登录到数据库</li><li>使用超级用户登录到数据库，对 <code>User1</code> 用户进行授权，允许 <code>User1</code> 访问 <code>Student</code> 表，允许 <code>User1</code> 修改 <code>C</code> 表中 <code>Cname</code> 属性列。然后再使用 <code>User1</code> 用户登录到数据库，观察其访问权限</li><li>使用 SQL 语句完成一下操作：定义一新的登录帐号 <code>Hu</code>、数据库用户 <code>Hu</code>，并授予其访问学生表 <code>S</code> 的 <code>SELECT</code> 权限，授予其修改 <code>Sname</code> 的权限，使用 <code>Hu</code> 登录数据库，分别查询修改 <code>S</code> 表，观察执行结果。使用 <code>REVOKE</code> 命令回收 <code>Hu</code> 的相应权限，再次使用 <code>Hu</code> 登录数据库，分别查询修改 <code>S</code> 表，观察执行结果</li></ol><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 安全性</span>
<span class="token comment">-- 1. 以 SA 身份登陆系统，创建数据库用户 User1，使用 User1 用户登录到数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> Stu20030839<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> LOGIN User1 <span class="token keyword">WITH</span> PASSWORD <span class="token operator">=</span> <span class="token string">&#39;123456&#39;</span><span class="token punctuation">,</span>
    DEFAULT_DATABASE <span class="token operator">=</span> Stu20030839<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> User1 <span class="token keyword">FOR</span> LOGIN User1<span class="token punctuation">;</span>

<span class="token comment">--2. 对 User1 用户进行授权</span>
<span class="token comment">--（1）允许 User1 访问 Student 表</span>
<span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span> <span class="token keyword">ON</span> S <span class="token keyword">TO</span> User1<span class="token punctuation">;</span>

<span class="token comment">--（2）允许 User1 修改 C 表中 CNAME 属性列</span>
<span class="token keyword">GRANT</span> <span class="token keyword">UPDATE</span> <span class="token keyword">ON</span> C<span class="token punctuation">(</span>Cname<span class="token punctuation">)</span> <span class="token keyword">TO</span> User1<span class="token punctuation">;</span>

<span class="token comment">--（3）查看User1权限</span>
<span class="token keyword">EXEC</span> SP_HELPROTECT <span class="token variable">@USERNAME</span> <span class="token operator">=</span> <span class="token string">&#39;User1&#39;</span><span class="token punctuation">;</span>

<span class="token comment">--查看所有用户</span>
<span class="token keyword">EXEC</span> SP_HELPUSER<span class="token punctuation">;</span>

<span class="token comment">--3. 使用 SQL 语句完成以下操作</span>
<span class="token comment">--（1）定义一新的登录帐号Hu</span>
<span class="token keyword">CREATE</span> LOGIN Hu <span class="token keyword">WITH</span> PASSWORD <span class="token operator">=</span> <span class="token string">&#39;123456&#39;</span><span class="token punctuation">,</span>
    DEFAULT_DATABASE <span class="token operator">=</span> Stu20030839<span class="token punctuation">;</span>

<span class="token comment">--（2）数据库用户 Hu</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> Hu <span class="token keyword">FOR</span> LOGIN Hu<span class="token punctuation">;</span>
<span class="token comment">-- 可以加入 WITH DEFAULT_SCHEMA=dbo</span>

<span class="token comment">--（3）授予其访问学生表 S 的 Select 权限，授予其修改 Sname 的权限</span>
<span class="token keyword">GRANT</span> <span class="token keyword">UPDATE</span><span class="token punctuation">(</span>Sname<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">SELECT</span> <span class="token keyword">ON</span> S <span class="token keyword">TO</span> Hu <span class="token keyword">WITH</span> <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span><span class="token punctuation">;</span>
<span class="token comment">--检验：</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> Sno<span class="token operator">=</span><span class="token number">992401</span>
    <span class="token keyword">UPDATE</span> S <span class="token keyword">SET</span> Sname<span class="token operator">=</span><span class="token string">&#39;李明&#39;</span> <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> Sno<span class="token operator">=</span><span class="token number">996401</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> S<span class="token punctuation">;</span>

<span class="token comment">--（4）使用 REVOKE 命令回收 Hu 的相应权限</span>
<span class="token keyword">REVOKE</span> <span class="token keyword">UPDATE</span><span class="token punctuation">(</span>Sname<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">SELECT</span> <span class="token keyword">ON</span> S <span class="token keyword">FROM</span> Hu <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">--（5）查看 Hu 的权限</span>
<span class="token keyword">EXEC</span> SP_HELPROTECT <span class="token variable">@USERNAME</span> <span class="token operator">=</span> <span class="token string">&#39;Hu&#39;</span><span class="token punctuation">;</span>

<span class="token comment">--完整性</span>
<span class="token comment">--1. 建立新表 S1</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> S1 <span class="token punctuation">(</span>
    Sno <span class="token keyword">BIGINT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    Sname <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Sex <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;男&#39;</span> <span class="token keyword">CHECK</span><span class="token punctuation">(</span>Sex <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Age <span class="token keyword">BIGINT</span> <span class="token keyword">CHECK</span><span class="token punctuation">(</span>Age<span class="token operator">&gt;</span><span class="token number">18</span> <span class="token operator">AND</span> Age <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Deptno <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token keyword">REFERENCES</span> Dept<span class="token punctuation">(</span>Deptno<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">--2. 使用 SQL 语句分别往表 S1 中插入两条记录</span>
<span class="token comment">-- 其中一条记录年龄为 0 岁，另一条记录系部编号为 100，观察提示信息，并进行分析。</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> S1<span class="token punctuation">(</span>Sno<span class="token punctuation">,</span> Sname<span class="token punctuation">,</span> Sex<span class="token punctuation">,</span> Age<span class="token punctuation">,</span> Deptno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> S1<span class="token punctuation">(</span>Sno<span class="token punctuation">,</span> Sname<span class="token punctuation">,</span> Sex<span class="token punctuation">,</span>Age<span class="token punctuation">,</span>Deptno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 3. 如何向表 SC 中插入一条记录 (996409, 10, 80)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> S<span class="token punctuation">(</span>Sno<span class="token punctuation">,</span>Deptno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">996409</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> C<span class="token punctuation">(</span>Cno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">996409</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="附录-b-数据库复习试卷" tabindex="-1"><a class="header-anchor" href="#附录-b-数据库复习试卷" aria-hidden="true">#</a> 附录 B：数据库复习试卷</h1><h2 id="_1-简答题" tabindex="-1"><a class="header-anchor" href="#_1-简答题" aria-hidden="true">#</a> 1. 简答题</h2><h3 id="_1-1-数据完整性约束" tabindex="-1"><a class="header-anchor" href="#_1-1-数据完整性约束" aria-hidden="true">#</a> 1.1 数据完整性约束</h3><p>举例说明数据完整性约束规则中的实体完整性约束，并说明在数据更新中的有关实体完整性约束的注意事项。</p><div class="hint-container warning"><p class="hint-container-title">注意</p><p><strong>实体完整性约束</strong>：主码是唯一的且其属性不存在空值。实体完整性约束要求表的每一行是唯一实体。</p></div><p>例如：选修（<u>学号，课程号</u>，成绩）</p><p>“学号，课程号” 为主码，“学号” 和 “课程号” 两个属性都不能取空值且元组不能重复。</p><p>数据更新时：</p><ol><li>主码必须唯一，如果和已有主码冲突会拒接修改</li><li>主码中的所有属性都不能存在空值</li><li>如果其他表含有外键引用到主码也要一并修改</li></ol><h3 id="_1-2-三级模式结构" tabindex="-1"><a class="header-anchor" href="#_1-2-三级模式结构" aria-hidden="true">#</a> 1.2 三级模式结构</h3><p>试述数据库系统的三级模式结构，并说明其优点。</p><p>三级结构：</p><ol><li>外模式：也称子模式或用户模式，一个数据库可以有多个外模式，但是一个应用程序只能使用一个外模式。它是数据库用户能够看见和使用的局部数据的逻辑结构和特征的描述，是数据库用户的数据视图，是与某一应用有关的数据的逻辑表示。外模式是保证数据库安全性的一个有力措施，因为每个用户只能看见和访问所对应的外模式中的数据，数据库中的其余数据是不可见的。数据库管理系统提供外模式数据定义语言（外模式 DDL）来严格地定义模式</li><li>模式：也称逻辑模式，是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图。一个数据库只有一个模式，数据库管理系统提供模式数据定义语言（模式 DDL）来严格地定义模式</li><li>内模式：也称存储模式，一个数据库只有一个内模式。它是数据物理结构和存放方式的描述，是数据在数据库内部的组织方式</li></ol><p>优点：</p><ul><li>保证数据的独立性</li><li>简化了用户接口</li><li>有利于数据共享</li><li>有利于数据的安全保密</li></ul><blockquote><p>数据库系统的三级模式是数据的三个抽象级别，它把数据的具体组织留给数据库系统管理，使用户能逻辑地、抽象地处理数据，而不必关心数据在计算机中的具体表现方式与存储方式。</p></blockquote><h3 id="_1-3-数据库恢复技术" tabindex="-1"><a class="header-anchor" href="#_1-3-数据库恢复技术" aria-hidden="true">#</a> 1.3 数据库恢复技术</h3><p>数据库恢复的基本技术有哪些？</p><p>数据库恢复技术有：</p><ol><li>数据转储，即 DBA 定期将整个数据库复制到磁带或另一个磁盘上保存起来的过程</li><li>登记日志文件，日志文件是用来记录事务对数据库的更新操作的文件，设立日志文件可以进行事务故障恢复、系统故障恢复、协助后备副本进行介质故障恢复</li></ol><h3 id="_1-4-数据库范式" tabindex="-1"><a class="header-anchor" href="#_1-4-数据库范式" aria-hidden="true">#</a> 1.4 数据库范式</h3><p>写出两个关系模式分别满足下面的要求，并说明理由：</p><ol><li>是 3NF 的关系模式</li><li>是 3NF，也是 BCNF 的关系模式</li></ol><p>答案略，按照范式规则任意构造即可，例如：</p><ul><li>学生（<u>学号</u>，姓名，年龄）</li><li>课程（<u>课程号</u>，课程名）</li><li>选修（<u>学号，课程号</u>，成绩）</li></ul><p>非主属性对键码不存在部分依赖和传递依赖，是 3NF 主属性对键码不存在部分依赖和传递依赖，主属性对非主属性不存在函数依赖是 BCNF。</p><h3 id="_1-5-数据库并发" tabindex="-1"><a class="header-anchor" href="#_1-5-数据库并发" aria-hidden="true">#</a> 1.5 数据库并发</h3><p>举例说明并发操作中的读脏数据的问题。</p><blockquote><p>当两个事务 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_1,\,T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 并发时，事务 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 修改某一数据，并将其写回磁盘，事务 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 读取同一数据后，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 由于某种原因回滚，这时 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 已修改过的数据恢复原值，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 读到的数据就与数据库中的数据不一致，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 读到的数据就为 “脏” 数据。</p></blockquote><table><thead><tr><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">R(X) = 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>:</mo><mo>=</mo><mi>X</mi><mo>∗</mo><mn>2</mn><mo>=</mo><mn>20</mn><mo separator="true">,</mo><mtext> </mtext><mi>W</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">X:=X*2=20,\,W(X)=20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">20</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">20</span></span></span></span></td><td></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">R(X) = 20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">20</span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>rollback</mtext></mrow><annotation encoding="application/x-tex">\text{rollback}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">rollback</span></span></span></span></span></td><td></td></tr></tbody></table><h2 id="_2-设计与计算题" tabindex="-1"><a class="header-anchor" href="#_2-设计与计算题" aria-hidden="true">#</a> 2. 设计与计算题</h2><h3 id="_2-1-关系模型" tabindex="-1"><a class="header-anchor" href="#_2-1-关系模型" aria-hidden="true">#</a> 2.1 关系模型</h3><p>设计一个学生选课系统，其中学生可以选多门课程，一门课程可以由多位学生选修，一门课程只能由一位教师开设，一位教师可以开设多门课程</p><ol><li><p>试画出 E-R 图</p><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div></li><li><p>转换成关系模型并标注主码、外码</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mo stretchy="false">(</mo><munder accentunder="true"><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi></mrow><mo stretchy="true">‾</mo></munder><mo separator="true">,</mo><mtext> </mtext><mi mathvariant="normal">s</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm Student(\underline{sno},\,sname)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">Student</span><span class="mopen">(</span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em;"><span style="top:-2.84em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">sno</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">sname</span><span class="mclose">)</span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">T</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mo stretchy="false">(</mo><munder accentunder="true"><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi></mrow><mo stretchy="true">‾</mo></munder><mo separator="true">,</mo><mtext> </mtext><mi mathvariant="normal">t</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm Teacher(\underline{tno},\,tname)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">Teacher</span><span class="mopen">(</span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6151em;"><span style="top:-2.84em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">tno</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">tname</span><span class="mclose">)</span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mo stretchy="false">(</mo><munder accentunder="true"><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi></mrow><mo stretchy="true">‾</mo></munder><mo separator="true">,</mo><mtext> </mtext><mi mathvariant="normal">c</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm Course(\underline{cno},\,cname)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">Course</span><span class="mopen">(</span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em;"><span style="top:-2.84em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">cno</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">cname</span><span class="mclose">)</span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">C</mi><mo stretchy="false">(</mo><msup><munder accentunder="true"><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">n</mi><msup><mi mathvariant="normal">o</mi><mo>∗</mo></msup><mo separator="true">,</mo><mtext> </mtext><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi></mrow></mrow><mo stretchy="true">‾</mo></munder><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm SC(\underline{sno^*,\,{cno}}^*)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1617em;vertical-align:-0.3944em;"></span><span class="mord"><span class="mord mathrm">SC</span><span class="mopen">(</span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-2.6456em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">sn</span><span class="mord"><span class="mord mathrm">o</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">cno</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7673em;"><span style="top:-3.1416em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">T</mi><mi mathvariant="normal">C</mi><mo stretchy="false">(</mo><msup><munder accentunder="true"><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">n</mi><msup><mi mathvariant="normal">o</mi><mo>∗</mo></msup><mo separator="true">,</mo><mtext> </mtext><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi></mrow></mrow><mo stretchy="true">‾</mo></munder><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm TC(\underline{tno^*,\,{cno}}^*)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1617em;vertical-align:-0.3944em;"></span><span class="mord"><span class="mord mathrm">TC</span><span class="mopen">(</span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-2.6456em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">tn</span><span class="mord"><span class="mord mathrm">o</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">cno</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7673em;"><span style="top:-3.1416em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li></ul><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo></mrow><annotation encoding="application/x-tex">*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord">∗</span></span></span></span> 表示外键，下划线表示主键。</p></li></ol><h3 id="_2-2-关系代数" tabindex="-1"><a class="header-anchor" href="#_2-2-关系代数" aria-hidden="true">#</a> 2.2 关系代数</h3><p>设有关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>，其中</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">R:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span></p><table><thead><tr><th>A</th><th>B</th><th>C</th></tr></thead><tbody><tr><td>1</td><td>4</td><td>7</td></tr><tr><td>2</td><td>5</td><td>8</td></tr></tbody></table><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">S:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span></p><table><thead><tr><th>B</th><th>D</th></tr></thead><tbody><tr><td>6</td><td>7</td></tr><tr><td>4</td><td>8</td></tr></tbody></table><p>计算：</p><ol><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mrow><mi mathvariant="normal">B</mi><mo>=</mo><mn>4</mn></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">S</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm \sigma_{B=4}(S)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">B</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">S</span><span class="mclose">)</span></span></span></span></span><table><thead><tr><th>B</th><th>D</th></tr></thead><tbody><tr><td>4</td><td>8</td></tr></tbody></table></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mrow><mi mathvariant="normal">B</mi><mo separator="true">,</mo><mi mathvariant="normal">C</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm \Pi_{B,C}(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">B</span><span class="mpunct mtight">,</span><span class="mord mathrm mtight">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">R</span><span class="mclose">)</span></span></span></span></span><table><thead><tr><th>B</th><th>C</th></tr></thead><tbody><tr><td>4</td><td>7</td></tr><tr><td>5</td><td>8</td></tr></tbody></table></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mi mathvariant="normal">B</mi></msub><mo stretchy="false">(</mo><mi mathvariant="normal">R</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi mathvariant="normal">Π</mi><mi mathvariant="normal">B</mi></msub><mo stretchy="false">(</mo><mi mathvariant="normal">S</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm \Pi_{B}(R)-\Pi_{B}(S)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">S</span><span class="mclose">)</span></span></span></span></span><table><thead><tr><th>B</th></tr></thead><tbody><tr><td>5</td></tr></tbody></table></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo>⋈</mo><mi mathvariant="normal">S</mi></mrow><annotation encoding="application/x-tex">\rm R \Join S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6883em;vertical-align:-0.005em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">S</span></span></span></span></span><table><thead><tr><th>A</th><th>B</th><th>C</th><th>D</th></tr></thead><tbody><tr><td>1</td><td>4</td><td>7</td><td>8</td></tr></tbody></table></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mi mathvariant="normal">B</mi></msub><mo stretchy="false">(</mo><mi mathvariant="normal">R</mi><mo stretchy="false">)</mo><mo>∩</mo><msub><mi mathvariant="normal">Π</mi><mi mathvariant="normal">B</mi></msub><mo stretchy="false">(</mo><mi mathvariant="normal">S</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm \Pi_{B}(R) \cap \Pi_{B}(S)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">S</span><span class="mclose">)</span></span></span></span></span><table><thead><tr><th>B</th></tr></thead><tbody><tr><td>4</td></tr></tbody></table></li></ol><h2 id="_3-综合题" tabindex="-1"><a class="header-anchor" href="#_3-综合题" aria-hidden="true">#</a> 3. 综合题</h2><h3 id="_3-1-关系代数和-sql" tabindex="-1"><a class="header-anchor" href="#_3-1-关系代数和-sql" aria-hidden="true">#</a> 3.1 关系代数和 SQL</h3><p>给定下面关系：</p><ul><li>学生：<code>student(sno, sname, sex, sage, deptno)</code></li><li>课程：<code>course(cno, cname, cpno, ccredit)</code></li><li>选课：<code>sc(sno, cno, grade)</code></li><li>系：<code>dept(deptno, deptname)</code></li></ul><p>1-3 题使用关系代数查询，其余使用 SQL：</p><ol><li>查询性别 <code>sex</code> 为 <code>&#39;男&#39;</code>，并且年龄 <code>sage</code> 大于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>20</mn></mrow><annotation encoding="application/x-tex">20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">20</span></span></span></span> 岁的学生信息<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>σ</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mo>=</mo><mtext>‘男’</mtext><mo>∧</mo><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">e</mi><mo>&gt;</mo><mn>20</mn></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> \rm \sigma_{sex=\text{`男&#39;} \land age &gt; 20}(student) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">sex</span><span class="mrel mtight">=</span><span class="mord text mtight"><span class="mord mtight">‘</span><span class="mord cjk_fallback mtight">男</span><span class="mord mtight">’</span></span><span class="mbin mtight">∧</span><span class="mord mathrm mtight">age</span><span class="mrel mtight">&gt;</span><span class="mord mathrm mtight">20</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">student</span><span class="mclose">)</span></span></span></span></span></span></p></li><li>查询选修了课程名 <code>cname</code> 为 <code>&#39;数据库&#39;</code> 的学生号 <code>sno</code>，成绩 <code>grade</code><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi><mo separator="true">,</mo><mtext> </mtext><mi mathvariant="normal">g</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>σ</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mo>=</mo><mtext>‘数据库’</mtext></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">c</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mo>⋈</mo><mi mathvariant="normal">g</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> \rm \Pi_{sno,\,grade}(\sigma_{ cname=\text{`数据库&#39;}}(course \Join grade)) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">sno</span><span class="mpunct mtight">,</span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathrm mtight">grade</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">cname</span><span class="mrel mtight">=</span><span class="mord text mtight"><span class="mord mtight">‘</span><span class="mord cjk_fallback mtight">数据库</span><span class="mord mtight">’</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">course</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">grade</span><span class="mclose">))</span></span></span></span></span></span></p></li><li>查询学号 <code>sno</code> 为 <code>&#39;180101&#39;</code> 学生没有选修的课程号 <code>cno</code><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">c</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi mathvariant="normal">Π</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>σ</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi><mo>=</mo><mn>180101</mn></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">s</mi><mi mathvariant="normal">c</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> \rm \Pi_{cno}(course) - \Pi_{cno}(\sigma_{sno=180101}(sc)) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">cno</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">course</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">cno</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">sno</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">180101</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">sc</span><span class="mclose">))</span></span></span></span></span></span></p></li><li>建立本题目中的 <code>course</code> 表，其中 <code>cno</code> 为 <code>char(10)</code> 类型，<code>cname</code> 为 <code>char(20)</code> 类型，<code>cpno</code> 为 <code>char(10)</code> 类型，<code>ccredit</code> 为 <code>int</code> 类型，主码为 <code>(sno)</code>，外码为 <code>cpno</code> 参照 <code>course</code> 表的 <code>cno</code><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> course<span class="token punctuation">(</span>
    cno <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    cname <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    cpno <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ccredit <span class="token keyword">INT</span><span class="token punctuation">,</span>
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>cpno<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> course<span class="token punctuation">(</span>cno<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li><li>在 <code>course</code> 表中插入 <code>cno</code> 为 <code>&#39;C3&#39;</code>，<code>cname</code> 为 <code>&#39;数据科学&#39;</code>，<code>cpno</code> 为 <code>&#39;C1&#39;</code>，<code>ccredit</code> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> 的数据<div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> course <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;C3&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;数据科学&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;C1&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li><li>查询姓张的学生的学号 <code>sno</code> 和姓名 <code>sname</code><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> sno<span class="token punctuation">,</span> sname <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> sname <span class="token operator">like</span> <span class="token string">&#39;张%&#39;</span><span class="token punctuation">;</span>
</code></pre></div></li><li>查询所有课程的信息，要求按学分 <code>ccredit</code> 降序排列<div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> course <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> ccredit <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre></div></li><li>查询课程编号 <code>cno</code>，及每门课程的选课人数<div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> cno<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>sno<span class="token punctuation">)</span> <span class="token keyword">FROM</span> sc <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> cno<span class="token punctuation">;</span>
</code></pre></div></li><li>查询所有学生都选修了的课程编号 <code>cno</code> 和课程名 <code>cname</code><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> cno<span class="token punctuation">,</span> cname <span class="token keyword">FROM</span> course <span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sc
        <span class="token keyword">WHERE</span> sc<span class="token punctuation">.</span>sno <span class="token operator">=</span> student<span class="token punctuation">.</span>sno <span class="token operator">and</span> sc<span class="token punctuation">.</span>cno <span class="token operator">=</span> course<span class="token punctuation">.</span>cno
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li><li>将 <code>course</code> 表中 <code>cno</code> 为 <code>&#39;C3&#39;</code> 的 <code>credit</code> 改为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> course <span class="token keyword">SET</span> ccredit <span class="token operator">=</span> <span class="token number">3</span> <span class="token keyword">WHERE</span> cno <span class="token operator">=</span> <span class="token string">&#39;C3&#39;</span><span class="token punctuation">;</span>
</code></pre></div></li></ol><h3 id="_3-2-候选码" tabindex="-1"><a class="header-anchor" href="#_3-2-候选码" aria-hidden="true">#</a> 3.2 候选码</h3><p>关系模式 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo separator="true">,</mo><mtext> </mtext><mi>F</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U,\,F)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mclose">)</span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mi>B</mi><mi>C</mi><mi>D</mi><mi>E</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mi>F</mi><mo>=</mo><mo stretchy="false">{</mo><mi>A</mi><mo>→</mo><mi>B</mi><mo separator="true">,</mo><mtext> </mtext><mi>C</mi><mo>→</mo><mi>E</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">U = (ABCDE),\,F = \{A \to B,\,C \to E\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">}</span></span></span></span></p><ol><li>求 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mi>C</mi><msubsup><mo stretchy="false">)</mo><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">(AC)_F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.105em;vertical-align:-0.2935em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8115em;"><span style="top:-2.4065em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2935em;"><span></span></span></span></span></span></span></span></span></span></li><li>求候选码，说明步骤和判断理由</li></ol><p>解答：</p><p>(1)</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mi>C</mi><msubsup><mo stretchy="false">)</mo><mi>F</mi><mo>+</mo></msubsup><mo>=</mo><mo stretchy="false">{</mo><mi>A</mi><mo separator="true">,</mo><mtext> </mtext><mi>C</mi><mo separator="true">,</mo><mtext> </mtext><mi>B</mi><mo separator="true">,</mo><mtext> </mtext><mi>E</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex"> (AC)_F^+ = \{A,\,C,\,B,\,E\} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.105em;vertical-align:-0.2837em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-2.4163em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2837em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">}</span></span></span></span></span></p><p>(2)</p><p>首先将关系模式分类：</p><ul><li>L 类：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mtext> </mtext><mi>C</mi></mrow><annotation encoding="application/x-tex">A,\,C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></li><li>R 类：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo separator="true">,</mo><mtext> </mtext><mi>E</mi></mrow><annotation encoding="application/x-tex">B,\,E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span></li><li>N 类：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></li><li>LR 类：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mclose">}</span></span></span></span></li></ul><p>那么候选码就是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>A</mi><mi>C</mi><mi>D</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{(ACD)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)}</span></span></span></span>。</p><h3 id="_3-3-事务" tabindex="-1"><a class="header-anchor" href="#_3-3-事务" aria-hidden="true">#</a> 3.3 事务</h3><p>设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_1,\,T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是如下两个事务，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mtext> </mtext><mi>B</mi></mrow><annotation encoding="application/x-tex">A,\,B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> 为数据库中两个数据项，设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 的初值为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> 的初值为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>T</mi><mn>1</mn></msub><mo>:</mo><mspace width="1em"></mspace><mi>A</mi><mo>:</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>B</mi><mo>+</mo><mn>10</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>T</mi><mn>2</mn></msub><mo>:</mo><mspace width="1em"></mspace><mi>B</mi><mo>:</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>A</mi><mo>∗</mo><mi>B</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{aligned} T_1:\quad A: &amp; = B + 10 \\ T_2:\quad B: &amp; = A * B \end{aligned} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">10</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>若允许这两个事务并行执行，试给出下列调度：</p><ol><li>遵循两段锁协议且可串行化调度 <table><thead><tr><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mtext>  </mtext><mi mathvariant="normal">A</mi></mrow><annotation encoding="application/x-tex">\rm Slock\;A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">Slock</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">A</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\rm R(A)=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">10</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">X</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mtext>  </mtext><mi mathvariant="normal">B</mi></mrow><annotation encoding="application/x-tex">\rm Xlock\;B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">Xlock</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">B</span></span></span></span></span></td><td></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mtext>  </mtext><mi mathvariant="normal">B</mi></mrow><annotation encoding="application/x-tex">\rm Slock\;B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">Slock</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">B</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">B</mi><mo>=</mo><mi mathvariant="normal">A</mi><mo>∗</mo><mi mathvariant="normal">B</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">\rm B=A*B=100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathrm">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathrm">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">100</span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">W</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">\rm W(B)=100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">W</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">100</span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm commit</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">commit</span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">u</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mtext>  </mtext><mi mathvariant="normal">B</mi></mrow><annotation encoding="application/x-tex">\rm unlock\;B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">unlock</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">B</span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">u</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mtext>  </mtext><mi mathvariant="normal">A</mi></mrow><annotation encoding="application/x-tex">\rm unlock\;A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">unlock</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">A</span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">\rm R(B)=100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">100</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">X</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mtext>  </mtext><mi mathvariant="normal">A</mi></mrow><annotation encoding="application/x-tex">\rm Xlock\;A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">Xlock</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">A</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">A</mi><mo>=</mo><mi mathvariant="normal">B</mi><mo>+</mo><mn>10</mn><mo>=</mo><mn>110</mn></mrow><annotation encoding="application/x-tex">\rm A=B+10=110</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathrm">10</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">110</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">W</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo><mo>=</mo><mn>110</mn></mrow><annotation encoding="application/x-tex">\rm W(A)=110</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">W</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">110</span></span></span></span></span></td></tr></tbody></table></li><li>遵循两段锁协议但发生死锁调度 <table><thead><tr><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mtext>  </mtext><mi mathvariant="normal">A</mi></mrow><annotation encoding="application/x-tex">\rm Slock\;A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">Slock</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">A</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\rm R(A)=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">10</span></span></span></span></span></td><td></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mtext>  </mtext><mi mathvariant="normal">B</mi></mrow><annotation encoding="application/x-tex">\rm Slock\;B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">Slock</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">B</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\rm R(B)=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">10</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">X</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mtext>  </mtext><mi mathvariant="normal">B</mi></mrow><annotation encoding="application/x-tex">\rm Xlock\;B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">Xlock</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">B</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">X</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mtext>  </mtext><mi mathvariant="normal">A</mi></mrow><annotation encoding="application/x-tex">\rm Xlock\;A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">Xlock</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">A</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋯</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.313em;"></span><span class="minner">⋯</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td></tr></tbody></table></li></ol><h1 id="附录-c-数据库题库" tabindex="-1"><a class="header-anchor" href="#附录-c-数据库题库" aria-hidden="true">#</a> 附录 C：数据库题库</h1><h2 id="_1-简答题-1" tabindex="-1"><a class="header-anchor" href="#_1-简答题-1" aria-hidden="true">#</a> 1. 简答题</h2><ol><li>请简述数据库，并说明数据库管理系统的功能 <ul><li><strong>数据库</strong> 是长期储存在计算机内、有组织、可共享的大量数据的集合。数据库中的数据按一定的数据模型组织、描述和储存，具有较小的冗余度、较高的数据独立性和易扩展性，并可为各种用户共享</li><li><strong>数据库管理系统</strong>：是位于用户和操作系统之间的一层数据管理软件</li></ul></li><li>请说明数据库系统的三级模式与数据独立性 <ul><li>数据库系统的三级模式结构由外模式、模式和内模式组成</li><li>数据独立性包括数据的物理独立性和数据的逻辑独立性</li><li><strong>外模式</strong><ul><li>也称为 <strong>子模式</strong> 或 <strong>用户模式</strong> 它是数据库用户（包括程序员和最终用户）能够看见和使用的局部数据的逻辑结构和特征的描述，是数据库用户的数据视图，是与某一应用有关的数据的逻辑表示</li></ul></li><li><strong>模式</strong><ul><li>也称为 <strong>逻辑模式</strong>，是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图</li></ul></li><li><strong>内模式</strong><ul><li>也称 <strong>存储模式</strong>，一个数据库只有一个内模式，它是数据物理结构和存储方式的描述，是数据在数据库内部的组织方式</li></ul></li></ul></li><li>请简述数据完整性约束，并举例说明 <ul><li>三大完整性： <ol><li>实体完整性：主码唯一且非空</li><li>参照完整性：外码要么没有，要么只有一个</li><li>用户定义完整性 <ul><li>非空 <code>not null</code></li><li>列值唯一 <code>unique</code></li><li>条件表达式 <code>check in (&#39;男&#39;, &#39;女&#39;)</code></li></ul></li></ol></li><li>举例略</li></ul></li><li>请简述函数依赖，并举例说明完全函数依赖，部分函数依赖，传递函数依赖 <ul><li>某个属性集决定另一个属性集时，称另一属性集依赖于该属性集</li><li>举例： <ol><li>完全依赖：通过 <code>{学生学号，选修课程名}</code> 可以得到 <code>{该生本门选修课程的成绩}</code>，而通过单独的 <code>{学生学号}</code> 或者单独的 <code>{选修课程名}</code> 都无法得到该成绩，则说明 <code>{该生本门选修课程的成绩}</code> 完全依赖于 <code>{学生学号，选修课程名}</code></li><li>部分函数依赖：通过 <code>{学生学号，课程号}</code> 可以得到 <code>{该生姓名}</code>，而通过单独的 <code>{学生学号}</code> 已经能够得到 <code>{该生姓名}</code>，则说明 <code>{该生姓名}</code> 部分依赖于 <code>{学生学号，课程号}</code></li><li>传递函数依赖：在关系 <code>R(学号，宿舍，费用)</code>中，通过 <code>{学号}</code> 可以得到 <code>{宿舍}</code>，通过 <code>{宿舍}</code> 可以得到 <code>{费用}</code>，而反之都不成立，则存在传递依赖 <code>{学号} -&gt; {费用}</code></li></ol></li></ul></li><li>请说明 1NF，2NF，3NF，BCNF 概念，并举例说明 <ul><li>请参考上面的知识点</li></ul></li><li>请说明视图的作用 <ul><li>视图能够简化用户的操作</li><li>视图使用户能以多种角度看待同一数据</li><li>视图对重构数据库提供了一定程度的逻辑独立性</li><li>视图能够对机密数据提供安全保护</li><li>适度利用视图可以更清晰的表达查询</li></ul></li><li>请说明数据库设计的步骤及任务 <ol><li>需求分析：分析用户的需求，包括数据、功能和性能需求</li><li>概念结构设计：主要采用 E-R 模型进行设计，包括画 E-R 图</li><li>逻辑结构设计：通过将 E-R 图转换成表，实现从 E-R 模型到关系模型的转换</li><li>物理结构设计：主要是为所设计的数据库选择合适的存储结构和存取路径</li><li>数据库实施：包括编程、测试和试运行</li><li>数据库运行和维护：系统的运行与数据库的日常维护</li></ol></li><li>请说明在数据库设计过程中将 E-R 模型转换为关系数据模型的转换原则 <ul><li>E-R 图中的每个实体，对应一个关系，该关系具有属性为实体的全部属性，关键字为实体的关键字</li></ul></li><li>请说明针对不同故障恢复的策略 <ol><li>事务故障的恢复就是利用日志文件撤销此事务已对数据库进行的修改</li><li>系统故障的恢复就是要撤销故障发生时未完成的事务，重写已完成的事务</li><li>介质故障的恢复就是重装数据库，然后重写已完成的事务</li></ol></li><li>请举例说明丢失修改的调度序列，并将其修改为可串行化调度 <ul><li>略，参见上面的知识点</li></ul></li></ol><h2 id="_2-计算题" tabindex="-1"><a class="header-anchor" href="#_2-计算题" aria-hidden="true">#</a> 2. 计算题</h2><h3 id="_2-1-关系代数计算" tabindex="-1"><a class="header-anchor" href="#_2-1-关系代数计算" aria-hidden="true">#</a> 2.1 关系代数计算</h3><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">R:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span></p><table><thead><tr><th>A</th><th>B</th></tr></thead><tbody><tr><td>1</td><td>5</td></tr><tr><td>2</td><td>6</td></tr><tr><td>3</td><td>7</td></tr></tbody></table><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">S:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span></p><table><thead><tr><th>A</th><th>C</th><th>D</th></tr></thead><tbody><tr><td>5</td><td>5</td><td>1</td></tr><tr><td>2</td><td>6</td><td>2</td></tr><tr><td>6</td><td>7</td><td>3</td></tr></tbody></table><ol><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mrow><mi mathvariant="normal">A</mi><mo separator="true">,</mo><mi mathvariant="normal">C</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\rm \Pi_{A,C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">A</span><span class="mpunct mtight">,</span><span class="mord mathrm mtight">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">R</mi><mo>⋈</mo><mi mathvariant="normal">S</mi></mrow><annotation encoding="application/x-tex">\rm R \Join S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6883em;vertical-align:-0.005em;"></span><span class="mord"><span class="mord mathrm">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">S</span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mrow><mi mathvariant="normal">A</mi><mo>=</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\rm \sigma_{A=1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">A</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></li></ol><h3 id="_2-2-概念模型" tabindex="-1"><a class="header-anchor" href="#_2-2-概念模型" aria-hidden="true">#</a> 2.2 概念模型</h3><p>学校中有若干系，每个系有若干班级和教研室，每个教研室有若干教员，其中有的教授和副教授每人各带若干研究生，每个班有若干学生，每门课可由若干学生选修。请用 E-R 图画出该学校的概念模型，并转换为关系模型，表明主外码。</p><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><h2 id="_3-应用题" tabindex="-1"><a class="header-anchor" href="#_3-应用题" aria-hidden="true">#</a> 3. 应用题</h2><h3 id="_3-1-关系代数和-sql-编写" tabindex="-1"><a class="header-anchor" href="#_3-1-关系代数和-sql-编写" aria-hidden="true">#</a> 3.1 关系代数和 SQL 编写</h3><p>有关系模式四个：</p><ul><li>供应商关系：<code>S(Sno , Sname, Saddr)</code></li><li>零件关系：<code>P(Pno,  Pname, Color, Weight)</code></li><li>工程关系：<code>J(Jno, Jname, Jcity, Balance)</code></li><li>供应关系：<code>SPJ(Sno, Pno, Jno, Price, Qty)</code></li></ul><p>用关系代数（1-3）和 SQL（4-10）完成如下查询：</p><ol><li>检索没有发生任何供应关系的零件编号<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">P</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi mathvariant="normal">Π</mi><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">S</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">J</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> \rm \Pi_{Pno}(P) - \Pi_{Pno}(SPJ) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">Pno</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">Pno</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">SPJ</span><span class="mclose">)</span></span></span></span></span></span></p></li><li>检索使用了编号为 <code>P3</code> 或 <code>P5</code> 零件的工程编号 <code>Jno</code><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mrow><mi mathvariant="normal">J</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>σ</mi><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi><mo>=</mo><mtext>‘P3’</mtext><mo>∨</mo><mi mathvariant="normal">P</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi><mo>=</mo><mtext>‘P5’</mtext></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">S</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">J</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> \rm \Pi_{Jno}(\sigma_{Pno=\text{`P3&#39;}\lor Pno=\text{`P5&#39;}}(SPJ)) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">Jno</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">Pno</span><span class="mrel mtight">=</span><span class="mord text mtight"><span class="mord mtight">‘P3’</span></span><span class="mbin mtight">∨</span><span class="mord mathrm mtight">Pno</span><span class="mrel mtight">=</span><span class="mord text mtight"><span class="mord mtight">‘P5’</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">SPJ</span><span class="mclose">))</span></span></span></span></span></span></p></li><li>检索使用了红色零件的工程号 <code>Jno</code> 和工程名 <code>Jname</code><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Π</mi><mrow><mi mathvariant="normal">J</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi><mo separator="true">,</mo><mtext> </mtext><mi mathvariant="normal">J</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>σ</mi><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mo>=</mo><mtext>‘红色’</mtext></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">P</mi><mo>⋈</mo><mi mathvariant="normal">S</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">J</mi><mo>⋈</mo><mi mathvariant="normal">J</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> \rm \Pi_{Jno,\,Jname}(\sigma_{Color=\text{`红色&#39;}}(P \Join SPJ \Join J)) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">Jno</span><span class="mpunct mtight">,</span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathrm mtight">Jname</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">Color</span><span class="mrel mtight">=</span><span class="mord text mtight"><span class="mord mtight">‘</span><span class="mord cjk_fallback mtight">红色</span><span class="mord mtight">’</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">SPJ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">J</span><span class="mclose">))</span></span></span></span></span></span></p></li><li>定义表 <code>SPJ</code>，主码：<code>(Sno, Pno, Jno)</code>，外码 <code>Sno</code>、<code>Pno</code>，<code>Jno</code><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> SPJ <span class="token punctuation">(</span>
    Sno <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Pno <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Jno <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Price <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Qty <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Sno<span class="token punctuation">,</span> Pno<span class="token punctuation">,</span> Jno<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Sno<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> S<span class="token punctuation">(</span>Sno<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Pno<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> P<span class="token punctuation">(</span>Pno<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Jno<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> J<span class="token punctuation">(</span>Jno<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>定义使用红色零件的供应商名称和地址的视图<div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> S_1 <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> Sname<span class="token punctuation">,</span> Saddr <span class="token keyword">FROM</span> SPJ<span class="token punctuation">,</span> P<span class="token punctuation">,</span> S
<span class="token keyword">WHERE</span> SPJ<span class="token punctuation">.</span>Sno <span class="token operator">=</span> S<span class="token punctuation">.</span>Sno <span class="token operator">AND</span> SPJ<span class="token punctuation">.</span>Pno <span class="token operator">=</span> P<span class="token punctuation">.</span>Pno <span class="token operator">AND</span> Color <span class="token operator">=</span> <span class="token string">&#39;红色&#39;</span><span class="token punctuation">;</span>
</code></pre></div></li><li>将供应商 <code>S5</code> 提供的零件 <code>P4</code> 的价格提高 <code>6%</code><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> SPJ <span class="token keyword">SET</span> Price <span class="token operator">=</span> Price <span class="token operator">*</span> <span class="token number">1.06</span> <span class="token keyword">WHERE</span> Sno <span class="token operator">=</span> <span class="token string">&#39;S5&#39;</span> <span class="token operator">AND</span> Pno <span class="token operator">=</span> <span class="token string">&#39;P4&#39;</span><span class="token punctuation">;</span>
</code></pre></div></li><li>删除供应商号为 <code>S4</code> 的所有供应商记录<div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> SPJ <span class="token keyword">WHERE</span> Sno <span class="token operator">=</span> <span class="token string">&#39;S4&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> S <span class="token keyword">WHERE</span> Sno <span class="token operator">=</span> <span class="token string">&#39;S4&#39;</span><span class="token punctuation">;</span>
</code></pre></div></li><li>检索不使用编号为 <code>P3</code> 零件的工程编号 <code>Jno</code> 和工程名称 <code>Jname</code><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Jno<span class="token punctuation">,</span> Jname <span class="token keyword">FROM</span> J <span class="token keyword">WHERE</span> Jno <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> Jno <span class="token keyword">FROM</span> SPJ <span class="token keyword">WHERE</span> Pno <span class="token operator">=</span> <span class="token string">&#39;P3&#39;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li><li>检索至少使用了编号为 <code>P3</code> 和 <code>P5</code> 零件的工程编号 <code>Jno</code><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Jno <span class="token keyword">FROM</span> SPJ <span class="token keyword">WHERE</span> Pno <span class="token operator">=</span> <span class="token string">&#39;P3&#39;</span> <span class="token operator">AND</span> Jno <span class="token operator">IN</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> Jno <span class="token keyword">FROM</span> SPJ <span class="token keyword">WHERE</span> Pno <span class="token operator">=</span> <span class="token string">&#39;P5&#39;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li><li>检索使用了全部零件的工程名称 <code>Jname</code><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Jname <span class="token keyword">FROM</span> J <span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> P <span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SPJ <span class="token keyword">WHERE</span> SPJ<span class="token punctuation">.</span>Pno <span class="token operator">=</span> P<span class="token punctuation">.</span>Pno <span class="token operator">AND</span> SPJ<span class="token punctuation">.</span>Jno <span class="token operator">=</span> J<span class="token punctuation">.</span>Jno
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ol><h3 id="_3-2-关系的函数依赖和范式" tabindex="-1"><a class="header-anchor" href="#_3-2-关系的函数依赖和范式" aria-hidden="true">#</a> 3.2 关系的函数依赖和范式</h3><p>关系模式：销售（时间，顾客编号，顾客名，商品编号，商品名，数量，单价）。语义：任何时间，对于任何顾客，同一商品的单价相同。</p><ol><li>列出函数依赖</li><li>请判断该关系模式最高为第几范式，并说明理由</li><li>请把上面的关系模式转化为 3NF，说明原因并指明主码</li></ol><p>解答：</p><p>(1)</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>F</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">{</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>顾客编号</mtext><mo>→</mo><mtext>顾客名</mtext><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>商品编号</mtext><mo>→</mo><mtext>商品名</mtext><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>商品编号</mtext><mo>→</mo><mtext>单价</mtext><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>(时间, 顾客编号, 商品编号)</mtext><mo>→</mo><mtext>数量</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo stretchy="false" lspace="0em" rspace="0em">}</mo></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{aligned} F &amp;= \{ \\ &amp; \text{顾客编号} \to \text{顾客名}, \\ &amp; \text{商品编号} \to \text{商品名}, \\ &amp; \text{商品编号} \to \text{单价}, \\ &amp; \text{(时间, 顾客编号, 商品编号)} \to \text{数量} \\ \} \end{aligned} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9em;vertical-align:-4.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.75em;"><span style="top:-6.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:0.59em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mclose">}</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.75em;"><span style="top:-6.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{</span></span></span><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord cjk_fallback">顾客编号</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord cjk_fallback">顾客名</span></span><span class="mpunct">,</span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord cjk_fallback">商品编号</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord cjk_fallback">商品名</span></span><span class="mpunct">,</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord cjk_fallback">商品编号</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord cjk_fallback">单价</span></span><span class="mpunct">,</span></span></span><span style="top:-0.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">(</span><span class="mord cjk_fallback">时间</span><span class="mord">, </span><span class="mord cjk_fallback">顾客编号</span><span class="mord">, </span><span class="mord cjk_fallback">商品编号</span><span class="mord">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord cjk_fallback">数量</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>(2)</p><p>最高为 1NF，由于上述函数依赖集为：</p><ul><li>L 类：时间，顾客编号，商品编号</li><li>R 类：顾客名，商品名，单价，数量</li><li>N 类：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mclose">}</span></span></span></span></li><li>LR 类：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mclose">}</span></span></span></span></li></ul><p>所以</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">(</mo><mtext>时间</mtext><mo separator="true">,</mo><mtext> </mtext><mtext>顾客编号</mtext><mo separator="true">,</mo><mtext> </mtext><mtext>商品编号</mtext><msubsup><mo stretchy="false">)</mo><mi>F</mi><mo>+</mo></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mtext>时间</mtext><mo separator="true">,</mo><mtext> </mtext><mtext>顾客编号</mtext><mo separator="true">,</mo><mtext> </mtext><mtext>商品编号</mtext><mo separator="true">,</mo><mtext> </mtext><mtext>顾客名</mtext><mo separator="true">,</mo><mtext> </mtext><mtext>商品名</mtext><mo separator="true">,</mo><mtext> </mtext><mtext>单价</mtext><mo separator="true">,</mo><mtext> </mtext><mtext>数量</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>U</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{aligned} &amp; (\text{时间},\,\text{顾客编号},\,\text{商品编号})_F^+ \\ &amp; = ( \text{时间},\, \text{顾客编号},\, \text{商品编号},\, \text{顾客名},\, \text{商品名},\, \text{单价},\, \text{数量} ) \\ &amp; = U \end{aligned} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.5em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-3em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-1.5em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mopen">(</span><span class="mord text"><span class="mord cjk_fallback">时间</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">顾客编号</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">商品编号</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-2.4163em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2837em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord cjk_fallback">时间</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">顾客编号</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">商品编号</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">顾客名</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">商品名</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">单价</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">数量</span></span><span class="mclose">)</span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>那么关系模式的码为：（时间，顾客编号，商品编号），由于非主属性顾客名对码是部分函数依赖，所以不符合 2NF。</p><p>(3)</p><ul><li>顾客（<u>顾客编号</u>，顾客名）</li><li>商品（<u>商品编号</u>，商品名，单价）</li><li>销售（<u>时间，顾客编号，商品编号</u>，数量）</li></ul><p>非主属性顾客名对码不存在部分函数依赖，也不存在传递函数依赖，所以是 3NF。</p><h2 id="_4-其他相关题目" tabindex="-1"><a class="header-anchor" href="#_4-其他相关题目" aria-hidden="true">#</a> 4. 其他相关题目</h2><h3 id="_4-1-填空题" tabindex="-1"><a class="header-anchor" href="#_4-1-填空题" aria-hidden="true">#</a> 4.1 填空题</h3><ol><li>数据模型通常由 <u>数据结构，数据操作，完整性约束</u> 三个要素组成</li><li>有了 <u>外模式/模式</u> 可以保证数据和应用程序之间的逻辑独立性；有了 <u>内模式/模式</u>，可以保证数据和应用程序之间的物理独立性</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><msub><mi mathvariant="normal">F</mi><mn>1</mn></msub></msub><mo stretchy="false">(</mo><msub><mi>σ</mi><msub><mi mathvariant="normal">F</mi><mn>2</mn></msub></msub><mo stretchy="false">(</mo><mi mathvariant="normal">E</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm\sigma_{F_1}(\sigma_{F_2}(E))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">E</span><span class="mclose">))</span></span></span></span></span> 等价于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder accentunder="true"><mrow><msub><mi>σ</mi><mrow><msub><mi mathvariant="normal">F</mi><mn>1</mn></msub><mo>∧</mo><msub><mi mathvariant="normal">F</mi><mn>2</mn></msub></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">E</mi><mo stretchy="false">)</mo></mrow><mo stretchy="true">‾</mo></munder></mrow><annotation encoding="application/x-tex">\rm\underline{\sigma_{F_1 \land F_2}(E)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2001em;vertical-align:-0.4501em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5899em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">∧</span><span class="mord mtight"><span class="mord mathrm mtight">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathrm">E</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4501em;"><span></span></span></span></span></span></span></span></span></span></li><li>关系模式进行投影运算后属性数 <u>小于或等于</u> 原属性数</li><li>SQL 的数据定义语句包括：<u>定义表，定义视图，定义索引</u> 等</li><li>在 SQL 查询时，如果要去掉查询结果中的重复元组，需使用 <u><code>distinct</code></u></li><li>关系完备的系统支持 <u>关系数据结构</u>，和所有 <u>关系代数</u> 操作</li><li>事务具有 <u>原子性、一致性、隔离性、持续性</u> 的特性</li><li>在数据库系统中，定义存取权限称为 <u>授权</u></li><li>关系数据库规范化要解决的问题是插入异常，<u>删除异常，更新异常</u></li></ol><h3 id="_4-2-关系模型" tabindex="-1"><a class="header-anchor" href="#_4-2-关系模型" aria-hidden="true">#</a> 4.2 关系模型</h3><p>有一课程管理系统：一个系可开设多门课程，学生可选修多门课程，一名教师只教一门课程，但一门课程可有几名教师开设。</p><ol><li>试画出 E-R 图并标注属性<div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div></li><li>转换成关系模型 <ul><li><code>Dept(Deptno, Deptname, Dmanger)</code></li><li><code>Student(Sno, Sname, Sage, Deptno)</code></li><li><code>Teacher(Tno, Tname, Deptno, Cno)</code></li><li><code>Course(Cno, Cname, Credit, Deptno)</code></li><li><code>SC(Sno, Cno, Grade)</code></li></ul></li></ol><h3 id="_4-3-关系模式" tabindex="-1"><a class="header-anchor" href="#_4-3-关系模式" aria-hidden="true">#</a> 4.3 关系模式</h3><p>写出3个关系模式分别满足：</p><ol><li>是 1NF，不是 2NF</li><li>是 2NF，不是 3NF</li><li>是 3NF，也是 BCNF</li></ol><p>并说明所写的关系模式是前者，不是（或也是）后者。</p><p>答：</p><ol><li>学生选课（学号，姓名，课程号，成绩） <ul><li>属性不可分，是 1NF；存在非主属性对键码的部分依赖，不是 2NF</li></ul></li><li>学生（学号，姓名，系别，系主任） <ul><li>码为单属性，不存在部分依赖，是 2NF，存在非主属性对键码的传递依赖，不是 3NF</li></ul></li><li>学生（学号，姓名，年龄）；选修（学号，课程号，成绩） <ul><li>非主属性对键码不存在部分依赖和传递依赖，是 3NF，主属性对键码不存在部分依赖和传递依赖，主属性对非主属性不存在函数依赖是 BCNF</li></ul></li></ol><h3 id="_4-4-并发和故障恢复" tabindex="-1"><a class="header-anchor" href="#_4-4-并发和故障恢复" aria-hidden="true">#</a> 4.4 并发和故障恢复</h3><p>试述系统故障的恢复的策略和方法。</p><p>策略：要撤销故障发生时未完成的事务，重做已完成的事务。</p><p>步骤：</p><ol><li>正向扫描日志文件，找出在故障发生前已经提交的事务记录，将其事务标识记入重做队列。同时找出故障发生时尚未完成的事务，将其事务标识记入撤销队列</li><li>对撤销队列中的各个事务进行撤销处理</li><li>对重做队列中的各个事务进行重做处理</li></ol><p>并发操作可能导致哪几种数据不一致的现象？采用什么协议解决这几种数据不一致现象？</p><p>并发操作可能导致</p><ol><li>修改丢失</li><li>读 “脏” 数据</li><li>不可重复读</li></ol><p>3 种数据不一致现象。采用一级封锁协议可解决丢失修改的问题，二级封锁协议既可解决丢失修改的问题，也可解决读 “脏” 数据的问题，而三级封锁协议可解决上述 3 种数据不一致现象。</p><h3 id="_4-5-候选码和最小依赖集" tabindex="-1"><a class="header-anchor" href="#_4-5-候选码和最小依赖集" aria-hidden="true">#</a> 4.5 候选码和最小依赖集</h3><p>设关系模式 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>A</mi><mi>B</mi><mi>C</mi><mi>D</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(ABCD)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span></span> 上 FD 集为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mo stretchy="false">{</mo><mi>A</mi><mi>B</mi><mo>→</mo><mi>C</mi><mo separator="true">,</mo><mtext> </mtext><mi>A</mi><mo>→</mo><mi>B</mi><mo separator="true">,</mo><mtext> </mtext><mi>B</mi><mo>→</mo><mi>A</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">F = \{AB \to C,\, A\to B,\,B \to A\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">}</span></span></span></span>。</p><ol><li>试求 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的候选码</li><li>试求 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">F_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li></ol><p>解答：</p><p>(1)</p><ul><li>L 类：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mclose">}</span></span></span></span></li><li>R 类：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></li><li>N 类：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></li><li>LR 类：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mtext> </mtext><mi>B</mi></mrow><annotation encoding="application/x-tex">A,\,B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li></ul><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的候选码为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>B</mi><mi>D</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mo stretchy="false">(</mo><mi>A</mi><mi>D</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{(BD),\,(AD)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)}</span></span></span></span>。</p><p>(2)</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mi>m</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mi>B</mi><mo>→</mo><mi>C</mi><mo separator="true">,</mo><mtext> </mtext><mi>A</mi><mo>→</mo><mi>B</mi><mtext> </mtext><mtext> </mtext><mi>B</mi><mo>→</mo><mi>A</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex"> F_m = \{ B \to C,\, A \to B\,\, B \to A \} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">}</span></span></span></span></span></p><h3 id="_4-6-事务调度" tabindex="-1"><a class="header-anchor" href="#_4-6-事务调度" aria-hidden="true">#</a> 4.6 事务调度</h3><p>设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_1,\,T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是如下两个事务，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> 为数据库中某个数据项，设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 的初值为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>50</mn></mrow><annotation encoding="application/x-tex">50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">50</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> 的初值为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>20</mn></mrow><annotation encoding="application/x-tex">20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">20</span></span></span></span>。</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>T</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>:</mo><mi>A</mi><mo>:</mo><mo>=</mo><mi>B</mi><mo>∗</mo><mn>10</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>T</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>:</mo><mi>B</mi><mo>:</mo><mo>=</mo><mi>A</mi><mo>+</mo><mn>10</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{aligned} T_1 &amp;: A := B * 10 \\ T_2 &amp;: B := A + 10 \end{aligned} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">10</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">10</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>若允许这二个事务并行执行，试给出：</p><ol><li>不可串行化的调度</li><li>以及一个遵守两段锁协议的调度</li></ol><p>解答：</p><p>串行结果：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><msub><mi>T</mi><mn>2</mn></msub><mo>:</mo><mi>A</mi><mo>=</mo><mn>200</mn><mo separator="true">,</mo><mtext> </mtext><mi>B</mi><mo>=</mo><mn>210</mn></mrow><annotation encoding="application/x-tex">T_1 T_2:A=200,\,B=210</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">200</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">210</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub><msub><mi>T</mi><mn>1</mn></msub><mo>:</mo><mi>A</mi><mo>=</mo><mn>600</mn><mo separator="true">,</mo><mtext> </mtext><mi>B</mi><mo>=</mo><mn>60</mn></mrow><annotation encoding="application/x-tex">T_2 T_1:A=600,\,B=60</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">600</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">60</span></span></span></span></li></ul><p>（1）不可串行化的调度</p><table><thead><tr><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">d</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm read(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">read</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span></span></span></span></span></td><td></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">d</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm read(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">read</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">A</mi><mo>=</mo><mi mathvariant="normal">B</mi><mo>×</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\rm A=B \times 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathrm">10</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm write(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">write</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span></span></span></span></span></td><td></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">B</mi><mo>=</mo><mi mathvariant="normal">A</mi><mo>+</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\rm B=A+10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathrm">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathrm">10</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm write(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">write</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span></span></span></span></span></td></tr></tbody></table><p>（2）遵守两段锁协议的调度</p><table><thead><tr><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm Slock(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">Slock</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">d</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm read(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">read</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">X</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm Xlock(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">Xlock</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span></span></span></span></span></td><td></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm Slock(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">Slock</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">A</mi><mo>=</mo><mi mathvariant="normal">B</mi><mo>×</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\rm A=B \times 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathrm">10</span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm write(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">write</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm commit</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">commit</span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">u</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm unlock(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">unlock</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">u</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm unlock(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">unlock</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">d</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm read(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">read</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">X</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm Xlock(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">Xlock</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">B</mi><mo>=</mo><mi mathvariant="normal">A</mi><mo>+</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\rm B=A+10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathrm">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathrm">10</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm write(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">write</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm commit</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">commit</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">u</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm unlock(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">unlock</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">u</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm unlock(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">unlock</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span></span></span></span></span></td></tr></tbody></table><p>（3）遵守两段锁协议但发生死锁的调度</p><table><thead><tr><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm Slock(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">Slock</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">d</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm read(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">read</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span></span></span></span></span></td><td></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm Slock(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">Slock</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">d</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm read(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">read</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">X</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mo stretchy="false">(</mo><mi mathvariant="normal">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm Xlock(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">Xlock</span><span class="mopen">(</span><span class="mord mathrm">A</span><span class="mclose">)</span></span></span></span></span></td><td></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">X</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mo stretchy="false">(</mo><mi mathvariant="normal">B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rm Xlock(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">Xlock</span><span class="mopen">(</span><span class="mord mathrm">B</span><span class="mclose">)</span></span></span></span></span></td></tr><tr><td></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\rm wait</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord"><span class="mord mathrm">wait</span></span></span></span></span></td></tr></tbody></table></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/Sun-ZhenXing/vuepress-database-notes//edit/main/docs/database/index.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><!--]--> 在 GitHub 上编辑此页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1006925066@qq.com">Sun-ZhenXing</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!----><!--]--></div>
    <script type="module" src="/vuepress-database-notes/assets/app-50be7c2c.js" defer></script>
  </body>
</html>
